(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function R(){}const qt=t=>t;function Bn(t,e){for(const n in e)t[n]=e[n];return t}function ms(t){return t()}function Ar(){return Object.create(null)}function de(t){t.forEach(ms)}function Ue(t){return typeof t=="function"}function ne(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function mi(t){return Object.keys(t).length===0}function kn(t,...e){if(t==null)return R;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ee(t,e,n){t.$$.on_destroy.push(kn(e,n))}function yi(t,e,n,r){if(t){const s=ys(t,e,n,r);return t[0](s)}}function ys(t,e,n,r){return t[1]&&r?Bn(n.ctx.slice(),t[1](r(e))):n.ctx}function gi(t,e,n,r){if(t[2]&&r){const s=t[2](r(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],o=Math.max(e.dirty.length,s.length);for(let a=0;a<o;a+=1)i[a]=e.dirty[a]|s[a];return i}return e.dirty|s}return e.dirty}function _i(t,e,n,r,s,i){if(s){const o=ys(e,n,r,i);t.p(o,s)}}function bi(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Tr(t){return t??""}function ct(t,e,n){return t.set(n),e}const gs=typeof window<"u";let xn=gs?()=>window.performance.now():()=>Date.now(),lr=gs?t=>requestAnimationFrame(t):R;const ft=new Set;function _s(t){ft.forEach(e=>{e.c(t)||(ft.delete(e),e.f())}),ft.size!==0&&lr(_s)}function En(t){let e;return ft.size===0&&lr(_s),{promise:new Promise(n=>{ft.add(e={c:t,f:n})}),abort(){ft.delete(e)}}}function C(t,e){t.appendChild(e)}function bs(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function vi(t){const e=O("style");return wi(bs(t),e),e.sheet}function wi(t,e){return C(t.head||t,e),e.sheet}function A(t,e,n){t.insertBefore(e,n||null)}function P(t){t.parentNode&&t.parentNode.removeChild(t)}function ur(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function O(t){return document.createElement(t)}function ge(t){return document.createTextNode(t)}function I(){return ge(" ")}function Be(){return ge("")}function q(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Y(t){return function(e){return e.preventDefault(),t.call(this,e)}}function E(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ki(t){return Array.from(t.childNodes)}function Lt(t,e){e=""+e,t.data!==e&&(t.data=e)}function Me(t,e){t.value=e??""}function we(t,e,n){t.classList[n?"add":"remove"](e)}function vs(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}const cn=new Map;let fn=0;function xi(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Ei(t,e){const n={stylesheet:vi(e),rules:{}};return cn.set(t,n),n}function jt(t,e,n,r,s,i,o,a=0){const l=16.666/r;let u=`{
`;for(let g=0;g<=1;g+=l){const y=e+(n-e)*i(g);u+=g*100+`%{${o(y,1-y)}}
`}const c=u+`100% {${o(n,1-n)}}
}`,f=`__svelte_${xi(c)}_${a}`,d=bs(t),{stylesheet:p,rules:m}=cn.get(d)||Ei(d,t);m[f]||(m[f]=!0,p.insertRule(`@keyframes ${f} ${c}`,p.cssRules.length));const h=t.style.animation||"";return t.style.animation=`${h?`${h}, `:""}${f} ${r}ms linear ${s}ms 1 both`,fn+=1,f}function Bt(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=n.length-r.length;s&&(t.style.animation=r.join(", "),fn-=s,fn||$i())}function $i(){lr(()=>{fn||(cn.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&P(e)}),cn.clear())})}function ws(t,e,n,r){if(!e)return R;const s=t.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return R;const{delay:i=0,duration:o=300,easing:a=qt,start:l=xn()+i,end:u=l+o,tick:c=R,css:f}=n(t,{from:e,to:s},r);let d=!0,p=!1,m;function h(){f&&(m=jt(t,0,1,o,i,a,f)),i||(p=!0)}function g(){f&&Bt(t,m),d=!1}return En(y=>{if(!p&&y>=l&&(p=!0),p&&y>=u&&(c(1,0),g()),!d)return!1;if(p){const _=y-l,b=0+1*a(_/o);c(b,1-b)}return!0}),h(),c(0,1),g}function ks(t){const e=getComputedStyle(t);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:n,height:r}=e,s=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,cr(t,s)}}function cr(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),s=r.transform==="none"?"":r.transform;t.style.transform=`${s} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}let Dt;function Ct(t){Dt=t}function fr(){if(!Dt)throw new Error("Function called outside component initialization");return Dt}function xs(t){fr().$$.on_mount.push(t)}function Es(t){fr().$$.on_destroy.push(t)}function $s(){const t=fr();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=vs(e,n,{cancelable:r});return s.slice().forEach(o=>{o.call(t,i)}),!i.defaultPrevented}return!0}}const at=[],dn=[];let dt=[];const Kr=[],Si=Promise.resolve();let Dn=!1;function Ci(){Dn||(Dn=!0,Si.then(Ss))}function fe(t){dt.push(t)}const Cn=new Set;let rt=0;function Ss(){if(rt!==0)return;const t=Dt;do{try{for(;rt<at.length;){const e=at[rt];rt++,Ct(e),Pi(e.$$)}}catch(e){throw at.length=0,rt=0,e}for(Ct(null),at.length=0,rt=0;dn.length;)dn.pop()();for(let e=0;e<dt.length;e+=1){const n=dt[e];Cn.has(n)||(Cn.add(n),n())}dt.length=0}while(at.length);for(;Kr.length;)Kr.pop()();Dn=!1,Cn.clear(),Ct(t)}function Pi(t){if(t.fragment!==null){t.update(),de(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(fe)}}function Oi(t){const e=[],n=[];dt.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),dt=e}let xt;function dr(){return xt||(xt=Promise.resolve(),xt.then(()=>{xt=null})),xt}function ze(t,e,n){t.dispatchEvent(vs(`${e?"intro":"outro"}${n}`))}const en=new Set;let ke;function se(){ke={r:0,c:[],p:ke}}function ie(){ke.r||de(ke.c),ke=ke.p}function K(t,e){t&&t.i&&(en.delete(t),t.i(e))}function D(t,e,n,r){if(t&&t.o){if(en.has(t))return;en.add(t),ke.c.push(()=>{en.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const hr={duration:0};function pr(t,e,n){const r={direction:"in"};let s=e(t,n,r),i=!1,o,a,l=0;function u(){o&&Bt(t,o)}function c(){const{delay:d=0,duration:p=300,easing:m=qt,tick:h=R,css:g}=s||hr;g&&(o=jt(t,0,1,p,d,m,g,l++)),h(0,1);const y=xn()+d,_=y+p;a&&a.abort(),i=!0,fe(()=>ze(t,!0,"start")),a=En(b=>{if(i){if(b>=_)return h(1,0),ze(t,!0,"end"),u(),i=!1;if(b>=y){const v=m((b-y)/p);h(v,1-v)}}return i})}let f=!1;return{start(){f||(f=!0,Bt(t),Ue(s)?(s=s(r),dr().then(c)):c())},invalidate(){f=!1},end(){i&&(u(),i=!1)}}}function mr(t,e,n){const r={direction:"out"};let s=e(t,n,r),i=!0,o;const a=ke;a.r+=1;function l(){const{delay:u=0,duration:c=300,easing:f=qt,tick:d=R,css:p}=s||hr;p&&(o=jt(t,1,0,c,u,f,p));const m=xn()+u,h=m+c;fe(()=>ze(t,!1,"start")),En(g=>{if(i){if(g>=h)return d(0,1),ze(t,!1,"end"),--a.r||de(a.c),!1;if(g>=m){const y=f((g-m)/c);d(1-y,y)}}return i})}return Ue(s)?dr().then(()=>{s=s(r),l()}):l(),{end(u){u&&s.tick&&s.tick(1,0),i&&(o&&Bt(t,o),i=!1)}}}function $e(t,e,n,r){const s={direction:"both"};let i=e(t,n,s),o=r?0:1,a=null,l=null,u=null;function c(){u&&Bt(t,u)}function f(p,m){const h=p.b-o;return m*=Math.abs(h),{a:o,b:p.b,d:h,duration:m,start:p.start,end:p.start+m,group:p.group}}function d(p){const{delay:m=0,duration:h=300,easing:g=qt,tick:y=R,css:_}=i||hr,b={start:xn()+m,b:p};p||(b.group=ke,ke.r+=1),a||l?l=b:(_&&(c(),u=jt(t,o,p,h,m,g,_)),p&&y(0,1),a=f(b,h),fe(()=>ze(t,p,"start")),En(v=>{if(l&&v>l.start&&(a=f(l,h),l=null,ze(t,a.b,"start"),_&&(c(),u=jt(t,o,a.b,a.duration,0,g,i.css))),a){if(v>=a.end)y(o=a.b,1-o),ze(t,a.b,"end"),l||(a.b?c():--a.group.r||de(a.group.c)),a=null;else if(v>=a.start){const k=v-a.start;o=a.a+a.d*g(k/a.duration),y(o,1-o)}}return!!(a||l)}))}return{run(p){Ue(i)?dr().then(()=>{i=i(s),d(p)}):d(p)},end(){c(),a=l=null}}}function Cs(t,e){D(t,1,1,()=>{e.delete(t.key)})}function jr(t,e){t.f(),Cs(t,e)}function In(t,e,n,r,s,i,o,a,l,u,c,f){let d=t.length,p=i.length,m=d;const h={};for(;m--;)h[t[m].key]=m;const g=[],y=new Map,_=new Map,b=[];for(m=p;m--;){const x=f(s,i,m),T=n(x);let $=o.get(T);$?r&&b.push(()=>$.p(x,e)):($=u(T,x),$.c()),y.set(T,g[m]=$),T in h&&_.set(T,Math.abs(m-h[T]))}const v=new Set,k=new Set;function w(x){K(x,1),x.m(a,c),o.set(x.key,x),c=x.first,p--}for(;d&&p;){const x=g[p-1],T=t[d-1],$=x.key,N=T.key;x===T?(c=x.first,d--,p--):y.has(N)?!o.has($)||v.has($)?w(x):k.has(N)?d--:_.get($)>_.get(N)?(k.add($),w(x)):(v.add(N),d--):(l(T,o),d--)}for(;d--;){const x=t[d];y.has(x.key)||l(x,o)}for(;p;)w(g[p-1]);return de(b),g}function Q(t){t&&t.c()}function z(t,e,n,r){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),r||fe(()=>{const o=t.$$.on_mount.map(ms).filter(Ue);t.$$.on_destroy?t.$$.on_destroy.push(...o):de(o),t.$$.on_mount=[]}),i.forEach(fe)}function G(t,e){const n=t.$$;n.fragment!==null&&(Oi(n.after_update),de(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ai(t,e){t.$$.dirty[0]===-1&&(at.push(t),Ci(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ae(t,e,n,r,s,i,o,a=[-1]){const l=Dt;Ct(t);const u=t.$$={fragment:null,ctx:[],props:i,update:R,not_equal:s,bound:Ar(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Ar(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(t,e.props||{},(f,d,...p)=>{const m=p.length?p[0]:d;return u.ctx&&s(u.ctx[f],u.ctx[f]=m)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](m),c&&Ai(t,f)),d}):[],u.update(),c=!0,de(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const f=ki(e.target);u.fragment&&u.fragment.l(f),f.forEach(P)}else u.fragment&&u.fragment.c();e.intro&&K(t.$$.fragment),z(t,e.target,e.anchor,e.customElement),Ss()}Ct(l)}class le{$destroy(){G(this,1),this.$destroy=R}$on(e,n){if(!Ue(n))return R;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!mi(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const F=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,H=Object.keys,te=Array.isArray;function oe(t,e){return typeof e!="object"||H(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||F.Promise||(F.Promise=Promise);const _t=Object.getPrototypeOf,Ti={}.hasOwnProperty;function ye(t,e){return Ti.call(t,e)}function bt(t,e){typeof e=="function"&&(e=e(_t(t))),(typeof Reflect>"u"?H:Reflect.ownKeys)(e).forEach(n=>{Te(t,n,e[n])})}const Ps=Object.defineProperty;function Te(t,e,n,r){Ps(t,e,oe(n&&ye(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function ht(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Te(t.prototype,"constructor",t),{extend:bt.bind(null,t.prototype)}}}}const Ki=Object.getOwnPropertyDescriptor;function yr(t,e){let n;return Ki(t,e)||(n=_t(t))&&yr(n,e)}const ji=[].slice;function hn(t,e,n){return ji.call(t,e,n)}function Os(t,e){return e(t)}function $t(t){if(!t)throw new Error("Assertion Failed")}function As(t){F.setImmediate?setImmediate(t):setTimeout(t,0)}function Ts(t,e){return t.reduce((n,r,s)=>{var i=e(r,s);return i&&(n[i[0]]=i[1]),n},{})}function Ke(t,e){if(ye(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,s=e.length;r<s;++r){var i=Ke(t,e[r]);n.push(i)}return n}var o=e.indexOf(".");if(o!==-1){var a=t[e.substr(0,o)];return a===void 0?void 0:Ke(a,e.substr(o+1))}}function pe(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){$t(typeof n!="string"&&"length"in n);for(var r=0,s=e.length;r<s;++r)pe(t,e[r],n[r])}else{var i=e.indexOf(".");if(i!==-1){var o=e.substr(0,i),a=e.substr(i+1);if(a==="")n===void 0?te(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=n;else{var l=t[o];l&&ye(t,o)||(l=t[o]={}),pe(l,a,n)}}else n===void 0?te(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Ks(t){var e={};for(var n in t)ye(t,n)&&(e[n]=t[n]);return e}const Bi=[].concat;function js(t){return Bi.apply([],t)}const Bs="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(js([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>F[t]),Di=Bs.map(t=>F[t]);Ts(Bs,t=>[t,!0]);let Re=null;function Ut(t){Re=typeof WeakMap<"u"&&new WeakMap;const e=Rn(t);return Re=null,e}function Rn(t){if(!t||typeof t!="object")return t;let e=Re&&Re.get(t);if(e)return e;if(te(t)){e=[],Re&&Re.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Rn(t[n]))}else if(Di.indexOf(t.constructor)>=0)e=t;else{const i=_t(t);for(var s in e=i===Object.prototype?{}:Object.create(i),Re&&Re.set(t,e),t)ye(t,s)&&(e[s]=Rn(t[s]))}return e}const{toString:Ii}={};function Nn(t){return Ii.call(t).slice(8,-1)}const Mn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ri=typeof Mn=="symbol"?function(t){var e;return t!=null&&(e=t[Mn])&&e.apply(t)}:function(){return null},lt={};function Oe(t){var e,n,r,s;if(arguments.length===1){if(te(t))return t.slice();if(this===lt&&typeof t=="string")return[t];if(s=Ri(t)){for(n=[];!(r=s.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const gr=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Se=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ds(t,e){Se=t,Is=e}var Is=()=>!0;const Ni=!new Error("").stack;function et(){if(Ni)try{throw et.arguments,new Error}catch(t){return t}return new Error}function Fn(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Is).map(r=>`
`+r).join("")):""}var Rs=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],_r=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Rs),Mi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pt(t,e){this._e=et(),this.name=t,this.message=e}function Ns(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,s)=>s.indexOf(n)===r).join(`
`)}function pn(t,e,n,r){this._e=et(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Ns(t,e)}function ut(t,e){this._e=et(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Ns(t,this.failures)}ht(pt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Fn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),ht(pn).from(pt),ht(ut).from(pt);var br=_r.reduce((t,e)=>(t[e]=e+"Error",t),{});const Fi=pt;var B=_r.reduce((t,e)=>{var n=e+"Error";function r(s,i){this._e=et(),this.name=n,s?typeof s=="string"?(this.message=`${s}${i?`
 `+i:""}`,this.inner=i||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=Mi[e]||n,this.inner=null)}return ht(r).from(Fi),t[e]=r,t},{});B.Syntax=SyntaxError,B.Type=TypeError,B.Range=RangeError;var Br=Rs.reduce((t,e)=>(t[e+"Error"]=B[e],t),{}),tn=_r.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=B[e]),t),{});function M(){}function It(t){return t}function qi(t,e){return t==null||t===It?e:function(n){return e(t(n))}}function Qe(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Li(t,e){return t===M?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Qe(r,this.onsuccess):r),s&&(this.onerror=this.onerror?Qe(s,this.onerror):s),i!==void 0?i:n}}function Ui(t,e){return t===M?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Qe(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Qe(r,this.onerror):r)}}function Wi(t,e){return t===M?e:function(n){var r=t.apply(this,arguments);oe(n,r);var s=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Qe(s,this.onsuccess):s),i&&(this.onerror=this.onerror?Qe(i,this.onerror):i),r===void 0?o===void 0?void 0:o:oe(r,o)}}function Vi(t,e){return t===M?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function vr(t,e){return t===M?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return n.then(function(){return e.apply(r,i)})}return e.apply(this,arguments)}}tn.ModifyError=pn,tn.DexieError=pt,tn.BulkError=ut;var Rt={};const[qn,mn,Ln]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,_t(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,_t(e),t]})(),Ms=mn&&mn.then,nn=qn&&qn.constructor,wr=!!Ln;var Un=!1,Hi=Ln?()=>{Ln.then(zt)}:F.setImmediate?setImmediate.bind(null,zt):F.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{zt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(zt,0)},Pt=function(t,e){St.push([t,e]),yn&&(Hi(),yn=!1)},Wn=!0,yn=!0,Ge=[],rn=[],Vn=null,Hn=It,mt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ir,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{Ir(t[0],t[1])}catch{}})}},j=mt,St=[],Ye=0,sn=[];function S(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=M,this._lib=!1;var e=this._PSD=j;if(Se&&(this._stackHolder=et(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Rt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Gn(this,this._value))}this._state=null,this._value=null,++e.ref,qs(this,t)}const zn={get:function(){var t=j,e=gn;function n(r,s){var i=!t.global&&(t!==j||e!==gn);const o=i&&!je();var a=new S((l,u)=>{kr(this,new Fs(_n(r,t,i,o),_n(s,t,i,o),l,u,t))});return Se&&Ws(a,this),a}return n.prototype=Rt,n},set:function(t){Te(this,"then",t&&t.prototype===Rt?zn:{get:function(){return t},set:zn.set})}};function Fs(t,e,n,r,s){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=s}function qs(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Wt();n&&typeof n.then=="function"?qs(t,(s,i)=>{n instanceof S?n._then(s,i):n.then(s,i)}):(t._state=!0,t._value=n,Ls(t)),r&&Vt()}},Gn.bind(null,t))}catch(n){Gn(t,n)}}function Gn(t,e){if(rn.push(e),t._state===null){var n=t._lib&&Wt();e=Hn(e),t._state=!1,t._value=e,Se&&e!==null&&typeof e=="object"&&!e._promise&&function(r,s,i){try{r.apply(null,i)}catch(o){s&&s(o)}}(()=>{var r=yr(e,"stack");e._promise=t,Te(e,"stack",{get:()=>Un?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Ge.some(s=>s._value===r._value)||Ge.push(r)}(t),Ls(t),n&&Vt()}}function Ls(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)kr(t,e[n]);var s=t._PSD;--s.ref||s.finalize(),Ye===0&&(++Ye,Pt(()=>{--Ye==0&&xr()},[]))}function kr(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Ye,Pt(zi,[n,t,e])}else t._listeners.push(e)}function zi(t,e,n){try{Vn=e;var r,s=e._value;e._state?r=t(s):(rn.length&&(rn=[]),r=t(s),rn.indexOf(s)===-1&&function(i){for(var o=Ge.length;o;)if(Ge[--o]._value===i._value)return void Ge.splice(o,1)}(e)),n.resolve(r)}catch(i){n.reject(i)}finally{Vn=null,--Ye==0&&xr(),--n.psd.ref||n.psd.finalize()}}function Us(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var s,i,o=t._value;o!=null?(s=o.name||"Error",i=o.message||o,r=Fn(o,0)):(s=o,i=""),e.push(s+(i?": "+i:"")+r)}return Se&&((r=Fn(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Us(t._prev,e,n)),e}function Ws(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function zt(){Wt()&&Vt()}function Wt(){var t=Wn;return Wn=!1,yn=!1,t}function Vt(){var t,e,n;do for(;St.length>0;)for(t=St,St=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(St.length>0);Wn=!0,yn=!0}function xr(){var t=Ge;Ge=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=sn.slice(0),n=e.length;n;)e[--n]()}function Gt(t){return new S(Rt,!1,t)}function L(t,e){var n=j;return function(){var r=Wt(),s=j;try{return qe(n,!0),t.apply(this,arguments)}catch(i){e&&e(i)}finally{qe(s,!1),r&&Vt()}}}bt(S.prototype,{then:zn,_then:function(t,e){kr(this,new Fs(null,null,t,e,j))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):Gt(r)):this.then(null,r=>r&&r.name===e?n(r):Gt(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),Gt(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Un=!0;var t=Us(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Un=!1}}},timeout:function(t,e){return t<1/0?new S((n,r)=>{var s=setTimeout(()=>r(new B.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Te(S.prototype,Symbol.toStringTag,"Dexie.Promise"),mt.env=Vs(),bt(S,{all:function(){var t=Oe.apply(null,arguments).map(Yt);return new S(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((s,i)=>S.resolve(s).then(o=>{t[i]=o,--r||e(t)},n))})},resolve:t=>{if(t instanceof S)return t;if(t&&typeof t.then=="function")return new S((n,r)=>{t.then(n,r)});var e=new S(Rt,!0,t);return Ws(e,Vn),e},reject:Gt,race:function(){var t=Oe.apply(null,arguments).map(Yt);return new S((e,n)=>{t.map(r=>S.resolve(r).then(e,n))})},PSD:{get:()=>j,set:t=>j=t},totalEchoes:{get:()=>gn},newPSD:Fe,usePSD:wt,scheduler:{get:()=>Pt,set:t=>{Pt=t}},rejectionMapper:{get:()=>Hn,set:t=>{Hn=t}},follow:(t,e)=>new S((n,r)=>Fe((s,i)=>{var o=j;o.unhandleds=[],o.onunhandled=i,o.finalize=Qe(function(){(function(a){function l(){a(),sn.splice(sn.indexOf(l),1)}sn.push(l),++Ye,Pt(()=>{--Ye==0&&xr()},[])})(()=>{this.unhandleds.length===0?s():i(this.unhandleds[0])})},o.finalize),t()},e,n,r))}),nn&&(nn.allSettled&&Te(S,"allSettled",function(){const t=Oe.apply(null,arguments).map(Yt);return new S(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((s,i)=>S.resolve(s).then(o=>r[i]={status:"fulfilled",value:o},o=>r[i]={status:"rejected",reason:o}).then(()=>--n||e(r)))})}),nn.any&&typeof AggregateError<"u"&&Te(S,"any",function(){const t=Oe.apply(null,arguments).map(Yt);return new S((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const s=new Array(r);t.forEach((i,o)=>S.resolve(i).then(a=>e(a),a=>{s[o]=a,--r||n(new AggregateError(s))}))})}));const Z={awaits:0,echoes:0,id:0};var Gi=0,on=[],Pn=0,gn=0,Yi=0;function Fe(t,e,n,r){var s=j,i=Object.create(s);i.parent=s,i.ref=0,i.global=!1,i.id=++Yi;var o=mt.env;i.env=wr?{Promise:S,PromiseProp:{value:S,configurable:!0,writable:!0},all:S.all,race:S.race,allSettled:S.allSettled,any:S.any,resolve:S.resolve,reject:S.reject,nthen:Dr(o.nthen,i),gthen:Dr(o.gthen,i)}:{},e&&oe(i,e),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=wt(i,t,n,r);return i.ref===0&&i.finalize(),a}function vt(){return Z.id||(Z.id=++Gi),++Z.awaits,Z.echoes+=100,Z.id}function je(){return!!Z.awaits&&(--Z.awaits==0&&(Z.id=0),Z.echoes=100*Z.awaits,!0)}function Yt(t){return Z.echoes&&t&&t.constructor===nn?(vt(),t.then(e=>(je(),e),e=>(je(),J(e)))):t}function Ji(t){++gn,Z.echoes&&--Z.echoes!=0||(Z.echoes=Z.id=0),on.push(j),qe(t,!0)}function Qi(){var t=on[on.length-1];on.pop(),qe(t,!1)}function qe(t,e){var n=j;if((e?!Z.echoes||Pn++&&t===j:!Pn||--Pn&&t===j)||Hs(e?Ji.bind(null,t):Qi),t!==j&&(j=t,n===mt&&(mt.env=Vs()),wr)){var r=mt.env.Promise,s=t.env;mn.then=s.nthen,r.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(F,"Promise",s.PromiseProp),r.all=s.all,r.race=s.race,r.resolve=s.resolve,r.reject=s.reject,s.allSettled&&(r.allSettled=s.allSettled),s.any&&(r.any=s.any))}}function Vs(){var t=F.Promise;return wr?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(F,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:mn.then,gthen:t.prototype.then}:{}}function wt(t,e,n,r,s){var i=j;try{return qe(t,!0),e(n,r,s)}finally{qe(i,!1)}}function Hs(t){Ms.call(qn,t)}function _n(t,e,n,r){return typeof t!="function"?t:function(){var s=j;n&&vt(),qe(e,!0);try{return t.apply(this,arguments)}finally{qe(s,!1),r&&Hs(je)}}}function Dr(t,e){return function(n,r){return t.call(this,_n(n,e),_n(r,e))}}(""+Ms).indexOf("[native code]")===-1&&(vt=je=M);function Ir(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,s={promise:e,reason:t};if(F.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),oe(r,s)):F.CustomEvent&&oe(r=new CustomEvent("unhandledrejection",{detail:s}),s),r&&F.dispatchEvent&&(dispatchEvent(r),!F.PromiseRejectionEvent&&F.onunhandledrejection))try{F.onunhandledrejection(r)}catch{}Se&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var J=S.reject;function Yn(t,e,n,r){if(t.idbdb&&(t._state.openComplete||j.letThrough||t._vip)){var s=t._createTransaction(e,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(i){return i.name===br.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Yn(t,e,n,r))):J(i)}return s._promise(e,(i,o)=>Fe(()=>(j.trans=s,r(i,o,s)))).then(i=>s._completion.then(()=>i))}if(t._state.openComplete)return J(new B.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return J(new B.DatabaseClosed);t.open().catch(M)}return t._state.dbReadyPromise.then(()=>Yn(t,e,n,r))}const He=String.fromCharCode(65535),Ce="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ot=[],$n=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Xi=$n,Zi=$n,zs=t=>!/(dexie\.js|dexie\.min\.js)/.test(t);function Xe(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Gs={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Jt(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Ut(e))[t],e)}function eo(){throw B.Type()}function V(t,e){try{const n=Rr(t),r=Rr(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(s,i){const o=s.length,a=i.length,l=o<a?o:a;for(let u=0;u<l;++u)if(s[u]!==i[u])return s[u]<i[u]?-1:1;return o===a?0:o<a?-1:1}(Nr(t),Nr(e));case"Array":return function(s,i){const o=s.length,a=i.length,l=o<a?o:a;for(let u=0;u<l;++u){const c=V(s[u],i[u]);if(c!==0)return c}return o===a?0:o<a?-1:1}(t,e)}}catch{}return NaN}function Rr(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=Nn(t);return n==="ArrayBuffer"?"binary":n}function Nr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class to{_trans(e,n,r){const s=this._tx||j.trans,i=this.name;function o(l,u,c){if(!c.schema[i])throw new B.NotFound("Table "+i+" not part of transaction");return n(c.idbtrans,c)}const a=Wt();try{return s&&s.db===this.db?s===j.trans?s._promise(e,o,r):Fe(()=>s._promise(e,o,r),{trans:s,transless:j.transless||j}):Yn(this.db,e,[this.name],o)}finally{a&&Vt()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(s=>this.hook.reading.fire(s))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(te(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=H(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(u=>u.compound&&n.every(c=>u.keyPath.indexOf(c)>=0)&&u.keyPath.every(c=>n.indexOf(c)>=0))[0];if(r&&this.db._maxKey!==He)return this.where(r.name).equals(r.keyPath.map(u=>e[u]));!r&&Se&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,i=this.db._deps.indexedDB;function o(u,c){return i.cmp(u,c)===0}const[a,l]=n.reduce(([u,c],f)=>{const d=s[f],p=e[f];return[u||d,u||!d?Xe(c,d&&d.multi?m=>{const h=Ke(m,f);return te(h)&&h.some(g=>o(p,g))}:m=>o(p,Ke(m,f))):c]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,te(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){const{db:n,name:r}=this;this.schema.mappedClass=e,e.prototype instanceof eo&&(e=class extends e{get db(){return n}table(){return r}});const s=new Set;for(let o=e.prototype;o;o=_t(o))Object.getOwnPropertyNames(o).forEach(a=>s.add(a));const i=o=>{if(!o)return o;const a=Object.create(e.prototype);for(let l in o)if(!s.has(l))try{a[l]=o[l]}catch{}return a};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),e}defineClass(){return this.mapToClass(function(e){oe(this,e)})}add(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let i=e;return s&&r&&(i=Jt(s)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:n!=null?[n]:null,values:[i]})).then(o=>o.numFailures?S.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{pe(e,s,o)}catch{}return o})}update(e,n){if(typeof e!="object"||te(e))return this.where(":id").equals(e).modify(n);{const r=Ke(e,this.schema.primKey.keyPath);if(r===void 0)return J(new B.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?H(n).forEach(s=>{pe(e,s,n[s])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let i=e;return s&&r&&(i=Jt(s)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[i],keys:n!=null?[n]:null})).then(o=>o.numFailures?S.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{pe(e,s,o)}catch{}return o})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?S.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Gs})).then(e=>e.numFailures?S.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(s=>this.hook.reading.fire(s))))}bulkAdd(e,n,r){const s=Array.isArray(n)?n:void 0,i=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&a?e.map(Jt(l)):e;return this.core.mutate({trans:o,type:"add",keys:s,values:c,wantResults:i}).then(({numFailures:f,results:d,lastResult:p,failures:m})=>{if(f===0)return i?d:p;throw new ut(`${this.name}.bulkAdd(): ${f} of ${u} operations failed`,m)})})}bulkPut(e,n,r){const s=Array.isArray(n)?n:void 0,i=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&a?e.map(Jt(l)):e;return this.core.mutate({trans:o,type:"put",keys:s,values:c,wantResults:i}).then(({numFailures:f,results:d,lastResult:p,failures:m})=>{if(f===0)return i?d:p;throw new ut(`${this.name}.bulkPut(): ${f} of ${u} operations failed`,m)})})}bulkUpdate(e){const n=this.core,r=e.map(o=>o.key),s=e.map(o=>o.changes),i=[];return this._trans("readwrite",o=>n.getMany({trans:o,keys:r,cache:"clone"}).then(a=>{const l=[],u=[];e.forEach(({key:f,changes:d},p)=>{const m=a[p];if(m){for(const h of Object.keys(d)){const g=d[h];if(h===this.schema.primKey.keyPath){if(V(g,f)!==0)throw new B.Constraint("Cannot update primary key in bulkUpdate()")}else pe(m,h,g)}i.push(p),l.push(f),u.push(m)}});const c=l.length;return n.mutate({trans:o,type:"put",keys:l,values:u,updates:{keys:r,changeSpecs:s}}).then(({numFailures:f,failures:d})=>{if(f===0)return c;for(const p of Object.keys(d)){const m=i[Number(p)];if(m!=null){const h=d[p];delete d[p],d[m]=h}}throw new ut(`${this.name}.bulkUpdate(): ${f} of ${c} operations failed`,d)})}))}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:s,failures:i})=>{if(r===0)return s;throw new ut(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,i)})}}function At(t){var e={},n=function(a,l){if(l){for(var u=arguments.length,c=new Array(u-1);--u;)c[u-1]=arguments[u];return e[a].subscribe.apply(null,c),t}if(typeof a=="string")return e[a]};n.addEventType=i;for(var r=1,s=arguments.length;r<s;++r)i(arguments[r]);return n;function i(a,l,u){if(typeof a=="object")return o(a);l||(l=Vi),u||(u=M);var c={subscribers:[],fire:u,subscribe:function(f){c.subscribers.indexOf(f)===-1&&(c.subscribers.push(f),c.fire=l(c.fire,f))},unsubscribe:function(f){c.subscribers=c.subscribers.filter(function(d){return d!==f}),c.fire=c.subscribers.reduce(l,u)}};return e[a]=n[a]=c,c}function o(a){H(a).forEach(function(l){var u=a[l];if(te(u))i(l,a[l][0],a[l][1]);else{if(u!=="asap")throw new B.InvalidArgument("Invalid event config");var c=i(l,It,function(){for(var f=arguments.length,d=new Array(f);f--;)d[f]=arguments[f];c.subscribers.forEach(function(p){As(function(){p.apply(null,d)})})})}})}}function Et(t,e){return ht(e).from({prototype:t}),e}function st(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function On(t,e){t.filter=Xe(t.filter,e)}function An(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Xe(r(),e()):e,t.justLimit=n&&!r}function an(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new B.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Mr(t,e,n){const r=an(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Qt(t,e,n,r){const s=t.replayFilter?Xe(t.filter,t.replayFilter()):t.filter;if(t.or){const i={},o=(a,l,u)=>{if(!s||s(l,u,d=>l.stop(d),d=>l.fail(d))){var c=l.primaryKey,f=""+c;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(c)),ye(i,f)||(i[f]=!0,e(a,l,u))}};return Promise.all([t.or._iterate(o,n),Fr(Mr(t,r,n),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}return Fr(Mr(t,r,n),Xe(t.algorithm,s),e,!t.keysOnly&&t.valueMapper)}function Fr(t,e,n,r){var s=L(r?(i,o,a)=>n(r(i),o,a):n);return t.then(i=>{if(i)return i.start(()=>{var o=()=>i.continue();e&&!e(i,a=>o=a,a=>{i.stop(a),o=M},a=>{i.fail(a),o=M})||s(i.value,i,a=>o=a),o()})})}class no{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,J.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,J.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Xe(n.algorithm,e)}_iterate(e,n){return Qt(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&oe(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>Qt(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,s=r.table.core;if(st(r,!0))return s.count({trans:n,query:{index:an(r,s.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var i=0;return Qt(r,()=>(++i,!1),n,s).then(()=>i)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),s=r[0],i=r.length-1;function o(u,c){return c?o(u[r[c]],c-1):u[s]}var a=this._ctx.dir==="next"?1:-1;function l(u,c){var f=o(u,i),d=o(c,i);return f<d?-a:f>d?a:0}return this.toArray(function(u){return u.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&st(r,!0)&&r.limit>0){const{valueMapper:s}=r,i=an(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then(({result:o})=>s?o.map(s):o)}{const s=[];return Qt(r,i=>s.push(i),n,r.table.core).then(()=>s)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,st(n)?An(n,()=>{var r=e;return(s,i)=>r===0||(r===1?(--r,!1):(i(()=>{s.advance(r),r=0}),!1))}):An(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),An(this._ctx,()=>{var n=e;return function(r,s,i){return--n<=0&&s(i),n>=0}},!0),this}until(e,n){return On(this._ctx,function(r,s,i){return!e(r.value)||(s(i),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return On(this._ctx,function(s){return e(s.value)}),n=this._ctx,r=e,n.isMatch=Xe(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.key,s)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.primaryKey,s)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,i){r.push(i.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&st(n,!0)&&n.limit>0)return this._read(s=>{var i=an(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:i,range:n.range}})}).then(({result:s})=>s).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,i){r.push(i.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return On(this._ctx,function(s){var i=s.primaryKey.toString(),o=ye(r,i);return r[i]=!0,!o}),this}modify(e){var n=this._ctx;return this._write(r=>{var s;if(typeof e=="function")s=e;else{var i=H(e),o=i.length;s=function(h){for(var g=!1,y=0;y<o;++y){var _=i[y],b=e[_];Ke(h,_)!==b&&(pe(h,_,b),g=!0)}return g}}const a=n.table.core,{outbound:l,extractKey:u}=a.schema.primaryKey,c=this.db._options.modifyChunkSize||200,f=[];let d=0;const p=[],m=(h,g)=>{const{failures:y,numFailures:_}=g;d+=h-_;for(let b of H(y))f.push(y[b])};return this.clone().primaryKeys().then(h=>{const g=y=>{const _=Math.min(c,h.length-y);return a.getMany({trans:r,keys:h.slice(y,y+_),cache:"immutable"}).then(b=>{const v=[],k=[],w=l?[]:null,x=[];for(let $=0;$<_;++$){const N=b[$],U={value:Ut(N),primKey:h[y+$]};s.call(U,U.value,U)!==!1&&(U.value==null?x.push(h[y+$]):l||V(u(N),u(U.value))===0?(k.push(U.value),l&&w.push(h[y+$])):(x.push(h[y+$]),v.push(U.value)))}const T=st(n)&&n.limit===1/0&&(typeof e!="function"||e===Tn)&&{index:n.index,range:n.range};return Promise.resolve(v.length>0&&a.mutate({trans:r,type:"add",values:v}).then($=>{for(let N in $.failures)x.splice(parseInt(N),1);m(v.length,$)})).then(()=>(k.length>0||T&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:w,values:k,criteria:T,changeSpec:typeof e!="function"&&e}).then($=>m(k.length,$))).then(()=>(x.length>0||T&&e===Tn)&&a.mutate({trans:r,type:"delete",keys:x,criteria:T}).then($=>m(x.length,$))).then(()=>h.length>y+_&&g(y+c))})};return g(0).then(()=>{if(f.length>0)throw new pn("Error modifying one or more objects",f,d,p);return h.length})})})}delete(){var e=this._ctx,n=e.range;return st(e)&&(e.isPrimKey&&!Zi||n.type===3)?this._write(r=>{const{primaryKey:s}=e.table.core.schema,i=n;return e.table.core.count({trans:r,query:{index:s,range:i}}).then(o=>e.table.core.mutate({trans:r,type:"deleteRange",range:i}).then(({failures:a,lastResult:l,results:u,numFailures:c})=>{if(c)throw new pn("Could not delete some values",Object.keys(a).map(f=>a[f]),o-c);return o-c}))}):this.modify(Tn)}}const Tn=(t,e)=>e.value=null;function ro(t,e){return t<e?-1:t===e?0:1}function so(t,e){return t>e?-1:t===e?0:1}function he(t,e,n){var r=t instanceof Js?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function it(t){return new t.Collection(t,()=>Ys("")).limit(0)}function io(t,e,n,r,s,i){for(var o=Math.min(t.length,r.length),a=-1,l=0;l<o;++l){var u=e[l];if(u!==r[l])return s(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):s(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;s(t[l],u)<0&&(a=l)}return o<r.length&&i==="next"?t+n.substr(t.length):o<t.length&&i==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function Xt(t,e,n,r){var s,i,o,a,l,u,c,f=n.length;if(!n.every(h=>typeof h=="string"))return he(t,"String expected.");function d(h){s=function(y){return y==="next"?_=>_.toUpperCase():_=>_.toLowerCase()}(h),i=function(y){return y==="next"?_=>_.toLowerCase():_=>_.toUpperCase()}(h),o=h==="next"?ro:so;var g=n.map(function(y){return{lower:i(y),upper:s(y)}}).sort(function(y,_){return o(y.lower,_.lower)});a=g.map(function(y){return y.upper}),l=g.map(function(y){return y.lower}),u=h,c=h==="next"?"":r}d("next");var p=new t.Collection(t,()=>Ie(a[0],l[f-1]+r));p._ondirectionchange=function(h){d(h)};var m=0;return p._addAlgorithm(function(h,g,y){var _=h.key;if(typeof _!="string")return!1;var b=i(_);if(e(b,l,m))return!0;for(var v=null,k=m;k<f;++k){var w=io(_,b,a[k],l[k],o,u);w===null&&v===null?m=k+1:(v===null||o(v,w)>0)&&(v=w)}return g(v!==null?function(){h.continue(v+c)}:y),!1}),p}function Ie(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Ys(t){return{type:1,lower:t,upper:t}}class Js{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,s){r=r!==!1,s=s===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||s)&&(!r||!s)?it(this):new this.Collection(this,()=>Ie(e,n,!r,!s))}catch{return he(this,Ce)}}equals(e){return e==null?he(this,Ce):new this.Collection(this,()=>Ys(e))}above(e){return e==null?he(this,Ce):new this.Collection(this,()=>Ie(e,void 0,!0))}aboveOrEqual(e){return e==null?he(this,Ce):new this.Collection(this,()=>Ie(e,void 0,!1))}below(e){return e==null?he(this,Ce):new this.Collection(this,()=>Ie(void 0,e,!1,!0))}belowOrEqual(e){return e==null?he(this,Ce):new this.Collection(this,()=>Ie(void 0,e))}startsWith(e){return typeof e!="string"?he(this,"String expected."):this.between(e,e+He,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Xt(this,(n,r)=>n.indexOf(r[0])===0,[e],He)}equalsIgnoreCase(e){return Xt(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=Oe.apply(lt,arguments);return e.length===0?it(this):Xt(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=Oe.apply(lt,arguments);return e.length===0?it(this):Xt(this,(n,r)=>r.some(s=>n.indexOf(s)===0),e,He)}anyOf(){const e=Oe.apply(lt,arguments);let n=this._cmp;try{e.sort(n)}catch{return he(this,Ce)}if(e.length===0)return it(this);const r=new this.Collection(this,()=>Ie(e[0],e[e.length-1]));r._ondirectionchange=i=>{n=i==="next"?this._ascending:this._descending,e.sort(n)};let s=0;return r._addAlgorithm((i,o,a)=>{const l=i.key;for(;n(l,e[s])>0;)if(++s,s===e.length)return o(a),!1;return n(l,e[s])===0||(o(()=>{i.continue(e[s])}),!1)}),r}notEqual(e){return this.inAnyRange([[-(1/0),e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Oe.apply(lt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return he(this,Ce)}const n=e.reduce((r,s)=>r?r.concat([[r[r.length-1][1],s]]):[[-(1/0),s]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,s=this._ascending,i=this._descending,o=this._min,a=this._max;if(e.length===0)return it(this);if(!e.every(_=>_[0]!==void 0&&_[1]!==void 0&&s(_[0],_[1])<=0))return he(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);const l=!n||n.includeLowers!==!1,u=n&&n.includeUppers===!0;let c,f=s;function d(_,b){return f(_[0],b[0])}try{c=e.reduce(function(_,b){let v=0,k=_.length;for(;v<k;++v){const w=_[v];if(r(b[0],w[1])<0&&r(b[1],w[0])>0){w[0]=o(w[0],b[0]),w[1]=a(w[1],b[1]);break}}return v===k&&_.push(b),_},[]),c.sort(d)}catch{return he(this,Ce)}let p=0;const m=u?_=>s(_,c[p][1])>0:_=>s(_,c[p][1])>=0,h=l?_=>i(_,c[p][0])>0:_=>i(_,c[p][0])>=0;let g=m;const y=new this.Collection(this,()=>Ie(c[0][0],c[c.length-1][1],!l,!u));return y._ondirectionchange=_=>{_==="next"?(g=m,f=s):(g=h,f=i),c.sort(d)},y._addAlgorithm((_,b,v)=>{for(var k=_.key;g(k);)if(++p,p===c.length)return b(v),!1;return!!function(w){return!m(w)&&!h(w)}(k)||(this._cmp(k,c[p][1])===0||this._cmp(k,c[p][0])===0||b(()=>{f===s?_.continue(c[p][0]):_.continue(c[p][1])}),!1)}),y}startsWithAnyOf(){const e=Oe.apply(lt,arguments);return e.every(n=>typeof n=="string")?e.length===0?it(this):this.inAnyRange(e.map(n=>[n,n+He])):he(this,"startsWithAnyOf() only works with strings")}}function be(t){return L(function(e){return Nt(e),t(e.target.error),!1})}function Nt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const Le=At(null,"storagemutated");class oo{_lock(){return $t(!j.global),++this._reculock,this._reculock!==1||j.global||(j.lockOwnerFor=this),this}_unlock(){if($t(!j.global),--this._reculock==0)for(j.global||(j.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{wt(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&j.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if($t(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new B.DatabaseClosed(r);case"MissingAPIError":throw new B.MissingAPI(r.message,r);default:throw new B.OpenFailed(r)}if(!this.active)throw new B.TransactionInactive;return $t(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=L(s=>{Nt(s),this._reject(e.error)}),e.onabort=L(s=>{Nt(s),this.active&&this._reject(new B.Abort(e.error)),this.active=!1,this.on("abort").fire(s)}),e.oncomplete=L(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Le.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return J(new B.ReadOnly("Transaction is readonly"));if(!this.active)return J(new B.TransactionInactive);if(this._locked())return new S((i,o)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(i,o)},j])});if(r)return Fe(()=>{var i=new S((o,a)=>{this._lock();const l=n(o,a,this);l&&l.then&&l.then(o,a)});return i.finally(()=>this._unlock()),i._lib=!0,i});var s=new S((i,o)=>{var a=n(i,o,this);a&&a.then&&a.then(i,o)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=S.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=o)})()}var i=n._waitingFor;return new S((o,a)=>{r.then(l=>n._waitingQueue.push(L(o.bind(null,l))),l=>n._waitingQueue.push(L(a.bind(null,l)))).finally(()=>{n._waitingFor===i&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(ye(n,e))return n[e];const r=this.schema[e];if(!r)throw new B.NotFound("Table "+e+" not part of transaction");const s=new this.db.Table(e,r,this);return s.core=this.db.core.table(e),n[e]=s,s}}function Jn(t,e,n,r,s,i,o){return{name:t,keyPath:e,unique:n,multi:r,auto:s,compound:i,src:(n&&!o?"&":"")+(r?"*":"")+(s?"++":"")+Qs(e)}}function Qs(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Xs(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Ts(n,r=>[r.name,r])}}let Mt=t=>{try{return t.only([[]]),Mt=()=>[[]],[[]]}catch{return Mt=()=>He,He}};function Qn(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?n=>n[e]:n=>Ke(n,e)}(t):e=>Ke(e,t)}function qr(t){return[].slice.call(t)}let ao=0;function Tt(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function lo(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:f,upperOpen:d}=l;return u===void 0?c===void 0?null:e.upperBound(c,!!d):c===void 0?e.lowerBound(u,!!f):e.bound(u,c,!!f,!!d)}const{schema:s,hasGetAll:i}=function(l,u){const c=qr(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(f=>u.objectStore(f)).map(f=>{const{keyPath:d,autoIncrement:p}=f,m=te(d),h=d==null,g={},y={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:m,keyPath:d,autoIncrement:p,unique:!0,extractKey:Qn(d)},indexes:qr(f.indexNames).map(_=>f.index(_)).map(_=>{const{name:b,unique:v,multiEntry:k,keyPath:w}=_,x={name:b,compound:te(w),keyPath:w,unique:v,multiEntry:k,extractKey:Qn(w)};return g[Tt(w)]=x,x}),getIndexByKeyPath:_=>g[Tt(_)]};return g[":id"]=y.primaryKey,d!=null&&(g[Tt(d)]=y.primaryKey),y})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),o=s.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:f,type:d,keys:p,values:m,range:h}){return new Promise((g,y)=>{g=L(g);const _=f.objectStore(c),b=_.keyPath==null,v=d==="put"||d==="add";if(!v&&d!=="delete"&&d!=="deleteRange")throw new Error("Invalid operation type: "+d);const{length:k}=p||m||{length:1};if(p&&m&&p.length!==m.length)throw new Error("Given keys array must have same length as given values array.");if(k===0)return g({numFailures:0,failures:{},results:[],lastResult:void 0});let w;const x=[],T=[];let $=0;const N=re=>{++$,Nt(re)};if(d==="deleteRange"){if(h.type===4)return g({numFailures:$,failures:T,results:[],lastResult:void 0});h.type===3?x.push(w=_.clear()):x.push(w=_.delete(r(h)))}else{const[re,X]=v?b?[m,p]:[m,null]:[p,null];if(v)for(let W=0;W<k;++W)x.push(w=X&&X[W]!==void 0?_[d](re[W],X[W]):_[d](re[W])),w.onerror=N;else for(let W=0;W<k;++W)x.push(w=_[d](re[W])),w.onerror=N}const U=re=>{const X=re.target.result;x.forEach((W,tt)=>W.error!=null&&(T[tt]=W.error)),g({numFailures:$,failures:T,results:d==="delete"?p:x.map(W=>W.result),lastResult:X})};w.onerror=re=>{N(re),U(re)},w.onsuccess=U})},getMany:({trans:f,keys:d})=>new Promise((p,m)=>{p=L(p);const h=f.objectStore(c),g=d.length,y=new Array(g);let _,b=0,v=0;const k=x=>{const T=x.target;y[T._pos]=T.result,++v===b&&p(y)},w=be(m);for(let x=0;x<g;++x)d[x]!=null&&(_=h.get(d[x]),_._pos=x,_.onsuccess=k,_.onerror=w,++b);b===0&&p(y)}),get:({trans:f,key:d})=>new Promise((p,m)=>{p=L(p);const h=f.objectStore(c).get(d);h.onsuccess=g=>p(g.target.result),h.onerror=be(m)}),query:function(f){return d=>new Promise((p,m)=>{p=L(p);const{trans:h,values:g,limit:y,query:_}=d,b=y===1/0?void 0:y,{index:v,range:k}=_,w=h.objectStore(c),x=v.isPrimaryKey?w:w.index(v.name),T=r(k);if(y===0)return p({result:[]});if(f){const $=g?x.getAll(T,b):x.getAllKeys(T,b);$.onsuccess=N=>p({result:N.target.result}),$.onerror=be(m)}else{let $=0;const N=g||!("openKeyCursor"in x)?x.openCursor(T):x.openKeyCursor(T),U=[];N.onsuccess=re=>{const X=N.result;return X?(U.push(g?X.value:X.primaryKey),++$===y?p({result:U}):void X.continue()):p({result:U})},N.onerror=be(m)}})}(i),openCursor:function({trans:f,values:d,query:p,reverse:m,unique:h}){return new Promise((g,y)=>{g=L(g);const{index:_,range:b}=p,v=f.objectStore(c),k=_.isPrimaryKey?v:v.index(_.name),w=m?h?"prevunique":"prev":h?"nextunique":"next",x=d||!("openKeyCursor"in k)?k.openCursor(r(b),w):k.openKeyCursor(r(b),w);x.onerror=be(y),x.onsuccess=L(T=>{const $=x.result;if(!$)return void g(null);$.___id=++ao,$.done=!1;const N=$.continue.bind($);let U=$.continuePrimaryKey;U&&(U=U.bind($));const re=$.advance.bind($),X=()=>{throw new Error("Cursor not stopped")};$.trans=f,$.stop=$.continue=$.continuePrimaryKey=$.advance=()=>{throw new Error("Cursor not started")},$.fail=L(y),$.next=function(){let W=1;return this.start(()=>W--?this.continue():this.stop()).then(()=>this)},$.start=W=>{const tt=new Promise((ue,We)=>{ue=L(ue),x.onerror=be(We),$.fail=We,$.stop=kt=>{$.stop=$.continue=$.continuePrimaryKey=$.advance=X,ue(kt)}}),nt=()=>{if(x.result)try{W()}catch(ue){$.fail(ue)}else $.done=!0,$.start=()=>{throw new Error("Cursor behind last entry")},$.stop()};return x.onsuccess=L(ue=>{x.onsuccess=nt,nt()}),$.continue=N,$.continuePrimaryKey=U,$.advance=re,nt(),tt},g($)},y)})},count({query:f,trans:d}){const{index:p,range:m}=f;return new Promise((h,g)=>{const y=d.objectStore(c),_=p.isPrimaryKey?y:y.index(p.name),b=r(m),v=b?_.count(b):_.count();v.onsuccess=L(k=>h(k.target.result)),v.onerror=be(g)})}}}(l)),a={};return o.forEach(l=>a[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!a[l])throw new Error(`Table '${l}' not found`);return a[l]},MIN_KEY:-1/0,MAX_KEY:Mt(e),schema:s}}function Xn({_novip:t},e){const n=e.db,r=function(s,i,{IDBKeyRange:o,indexedDB:a},l){return{dbcore:function(c,f){return f.reduce((d,{create:p})=>({...d,...p(d)}),c)}(lo(i,o,l),s.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(s=>{const i=s.name;t.core.schema.tables.some(o=>o.name===i)&&(s.core=t.core.table(i),t[i]instanceof t.Table&&(t[i].core=s.core))})}function bn({_novip:t},e,n,r){n.forEach(s=>{const i=r[s];e.forEach(o=>{const a=yr(o,s);(!a||"value"in a&&a.value===void 0)&&(o===t.Transaction.prototype||o instanceof t.Transaction?Te(o,s,{get(){return this.table(s)},set(l){Ps(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new t.Table(s,i))})})}function Zn({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function uo(t,e){return t._cfg.version-e._cfg.version}function co(t,e,n,r){const s=t._dbSchema,i=t._createTransaction("readwrite",t._storeNames,s);i.create(n),i._completion.catch(r);const o=i._reject.bind(i),a=j.transless||j;Fe(()=>{j.trans=i,j.transless=a,e===0?(H(s).forEach(l=>{Kn(n,l,s[l].primKey,s[l].indexes)}),Xn(t,n),S.follow(()=>t.on.populate.fire(i)).catch(o)):function({_novip:l},u,c,f){const d=[],p=l._versions;let m=l._dbSchema=tr(l,l.idbdb,f),h=!1;function g(){return d.length?S.resolve(d.shift()(c.idbtrans)).then(g):S.resolve()}return p.filter(y=>y._cfg.version>=u).forEach(y=>{d.push(()=>{const _=m,b=y._cfg.dbschema;nr(l,_,f),nr(l,b,f),m=l._dbSchema=b;const v=Zs(_,b);v.add.forEach(w=>{Kn(f,w[0],w[1].primKey,w[1].indexes)}),v.change.forEach(w=>{if(w.recreate)throw new B.Upgrade("Not yet support for changing primary key");{const x=f.objectStore(w.name);w.add.forEach(T=>er(x,T)),w.change.forEach(T=>{x.deleteIndex(T.name),er(x,T)}),w.del.forEach(T=>x.deleteIndex(T))}});const k=y._cfg.contentUpgrade;if(k&&y._cfg.version>u){Xn(l,f),c._memoizedTables={},h=!0;let w=Ks(b);v.del.forEach(N=>{w[N]=_[N]}),Zn(l,[l.Transaction.prototype]),bn(l,[l.Transaction.prototype],H(w),w),c.schema=w;const x=gr(k);let T;x&&vt();const $=S.follow(()=>{if(T=k(c),T&&x){var N=je.bind(null,null);T.then(N,N)}});return T&&typeof T.then=="function"?S.resolve(T):$.then(()=>T)}}),d.push(_=>{(!h||!Xi)&&function(b,v){[].slice.call(v.db.objectStoreNames).forEach(k=>b[k]==null&&v.db.deleteObjectStore(k))}(y._cfg.dbschema,_),Zn(l,[l.Transaction.prototype]),bn(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),g().then(()=>{var y,_;_=f,H(y=m).forEach(b=>{_.db.objectStoreNames.contains(b)||Kn(_,b,y[b].primKey,y[b].indexes)})})}(t,e,i,n).catch(o)})}function Zs(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const s=t[r],i=e[r];if(s){const o={name:r,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto&&!$n)o.recreate=!0,n.change.push(o);else{const a=s.idxByName,l=i.idxByName;let u;for(u in a)l[u]||o.del.push(u);for(u in l){const c=a[u],f=l[u];c?c.src!==f.src&&o.change.push(f):o.add.push(f)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}else n.add.push([r,i])}return n}function Kn(t,e,n,r){const s=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(i=>er(s,i)),s}function er(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function tr(t,e,n){const r={};return hn(e.objectStoreNames,0).forEach(s=>{const i=n.objectStore(s);let o=i.keyPath;const a=Jn(Qs(o),o||"",!1,!1,!!i.autoIncrement,o&&typeof o!="string",!0),l=[];for(let c=0;c<i.indexNames.length;++c){const f=i.index(i.indexNames[c]);o=f.keyPath;var u=Jn(f.name,o,!!f.unique,!!f.multiEntry,!1,o&&typeof o!="string",!1);l.push(u)}r[s]=Xs(s,a,l)}),r}function nr({_novip:t},e,n){const r=n.db.objectStoreNames;for(let s=0;s<r.length;++s){const i=r[s],o=n.objectStore(i);t._hasGetAll="getAll"in o;for(let a=0;a<o.indexNames.length;++a){const l=o.indexNames[a],u=o.index(l).keyPath,c=typeof u=="string"?u:"["+hn(u).join("+")+"]";if(e[i]){const f=e[i].idxByName[c];f&&(f.name=l,delete e[i].idxByName[c],e[i].idxByName[l]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&F.WorkerGlobalScope&&F instanceof F.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class fo{_parseStoresSpec(e,n){H(e).forEach(r=>{if(e[r]!==null){var s=e[r].split(",").map((o,a)=>{const l=(o=o.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Jn(l,u||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),te(u),a===0)}),i=s.shift();if(i.multi)throw new B.Schema("Primary key cannot be multi-valued");s.forEach(o=>{if(o.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),n[r]=Xs(r,i,s)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?oe(this._cfg.storesSource,e):e;const r=n._versions,s={};let i={};return r.forEach(o=>{oe(s,o._cfg.storesSource),i=o._cfg.dbschema={},o._parseStoresSpec(s,i)}),n._dbSchema=i,Zn(n,[n._allTables,n,n.Transaction.prototype]),bn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],H(i),i),n._storeNames=H(i),this}upgrade(e){return this._cfg.contentUpgrade=vr(this._cfg.contentUpgrade||M,e),this}}function Er(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Je("__dbnames",{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function $r(t){return t&&typeof t.databases=="function"}function rr(t){return Fe(function(){return j.letThrough=!0,t()})}function ho(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function po(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?J(e.dbOpenError):t);Se&&(e.openCanceller._stackHolder=et()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function s(){if(e.openCanceller!==r)throw new B.DatabaseClosed("db.open() was cancelled")}let i=e.dbReadyResolve,o=null,a=!1;return S.race([r,(typeof navigator>"u"?S.resolve():ho()).then(()=>new S((l,u)=>{if(s(),!n)throw new B.MissingAPI;const c=t.name,f=e.autoSchema?n.open(c):n.open(c,Math.round(10*t.verno));if(!f)throw new B.MissingAPI;f.onerror=be(u),f.onblocked=L(t._fireOnBlocked),f.onupgradeneeded=L(d=>{if(o=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=Nt,o.abort(),f.result.close();const m=n.deleteDatabase(c);m.onsuccess=m.onerror=L(()=>{u(new B.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{o.onerror=be(u);var p=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;a=p<1,t._novip.idbdb=f.result,co(t,p/10,o,u)}},u),f.onsuccess=L(()=>{o=null;const d=t._novip.idbdb=f.result,p=hn(d.objectStoreNames);if(p.length>0)try{const h=d.transaction((m=p).length===1?m[0]:m,"readonly");e.autoSchema?function({_novip:g},y,_){g.verno=y.version/10;const b=g._dbSchema=tr(0,y,_);g._storeNames=hn(y.objectStoreNames,0),bn(g,[g._allTables],H(b),b)}(t,d,h):(nr(t,t._dbSchema,h),function(g,y){const _=Zs(tr(0,g.idbdb,y),g._dbSchema);return!(_.add.length||_.change.some(b=>b.add.length||b.change.length))}(t,h)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Xn(t,h)}catch{}var m;Ot.push(t),d.onversionchange=L(h=>{e.vcFired=!0,t.on("versionchange").fire(h)}),d.onclose=L(h=>{t.on("close").fire(h)}),a&&function({indexedDB:h,IDBKeyRange:g},y){!$r(h)&&y!=="__dbnames"&&Er(h,g).put({name:y}).catch(M)}(t._deps,c),l()},u)}))]).then(()=>(s(),e.onReadyBeingFired=[],S.resolve(rr(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let u=e.onReadyBeingFired.reduce(vr,M);return e.onReadyBeingFired=[],S.resolve(rr(()=>u(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{o&&o.abort()}catch{}return r===e.openCanceller&&t._close(),J(l)}).finally(()=>{e.openComplete=!0,i()})}function sr(t){var e=i=>t.next(i),n=s(e),r=s(i=>t.throw(i));function s(i){return o=>{var a=i(o),l=a.value;return a.done?l:l&&typeof l.then=="function"?l.then(n,r):te(l)?Promise.all(l).then(n,r):n(l)}}return s(e)()}function mo(t,e,n){var r=arguments.length;if(r<2)throw new B.InvalidArgument("Too few arguments");for(var s=new Array(r-1);--r;)s[r-1]=arguments[r];n=s.pop();var i=js(s);return[t,i,n]}function ei(t,e,n,r,s){return S.resolve().then(()=>{const i=j.transless||j,o=t._createTransaction(e,n,t._dbSchema,r),a={trans:o,transless:i};if(r)o.idbtrans=r.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===br.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>ei(t,e,n,null,s))):J(f)}const l=gr(s);let u;l&&vt();const c=S.follow(()=>{if(u=s.call(o,o),u)if(l){var f=je.bind(null,null);u.then(f,f)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=sr(u))},a);return(u&&typeof u.then=="function"?S.resolve(u).then(f=>o.active?f:J(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(f=>(r&&o._resolve(),o._completion.then(()=>f))).catch(f=>(o._reject(f),J(f)))})}function Zt(t,e,n){const r=te(t)?t.slice():[t];for(let s=0;s<n;++s)r.push(e);return r}const yo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,s={},i=[];function o(c,f,d){const p=Tt(c),m=s[p]=s[p]||[],h=c==null?0:typeof c=="string"?1:c.length,g=f>0,y={...d,isVirtual:g,keyTail:f,keyLength:h,extractKey:Qn(c),unique:!g&&d.unique};return m.push(y),y.isPrimaryKey||i.push(y),h>1&&o(h===2?c[0]:c.slice(0,h-1),f+1,d),m.sort((_,b)=>_.keyTail-b.keyTail),y}const a=o(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[a];for(const c of r.indexes)o(c.keyPath,0,c);function l(c){const f=c.query.index;return f.isVirtual?{...c,query:{index:f,range:(d=c.query.range,p=f.keyTail,{type:d.type===1?2:d.type,lower:Zt(d.lower,d.lowerOpen?t.MAX_KEY:t.MIN_KEY,p),lowerOpen:!0,upper:Zt(d.upper,d.upperOpen?t.MIN_KEY:t.MAX_KEY,p),upperOpen:!0})}}:c;var d,p}return{...n,schema:{...r,primaryKey:a,indexes:i,getIndexByKeyPath:function(c){const f=s[Tt(c)];return f&&f[0]}},count:c=>n.count(l(c)),query:c=>n.query(l(c)),openCursor(c){const{keyTail:f,isVirtual:d,keyLength:p}=c.query.index;return d?n.openCursor(l(c)).then(m=>m&&function(h){return Object.create(h,{continue:{value:function(y){y!=null?h.continue(Zt(y,c.reverse?t.MAX_KEY:t.MIN_KEY,f)):c.unique?h.continue(h.key.slice(0,p).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,f)):h.continue()}},continuePrimaryKey:{value(y,_){h.continuePrimaryKey(Zt(y,t.MAX_KEY,f),_)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const y=h.key;return p===1?y[0]:y.slice(0,p)}},value:{get:()=>h.value}})}(m)):n.openCursor(c)}}}}}};function Sr(t,e,n,r){return n=n||{},r=r||"",H(t).forEach(s=>{if(ye(e,s)){var i=t[s],o=e[s];if(typeof i=="object"&&typeof o=="object"&&i&&o){const a=Nn(i);a!==Nn(o)?n[r+s]=e[s]:a==="Object"?Sr(i,o,n,r+s+"."):i!==o&&(n[r+s]=e[s])}else i!==o&&(n[r+s]=e[s])}else n[r+s]=void 0}),H(e).forEach(s=>{ye(t,s)||(n[r+s]=e[s])}),n}const go={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(i){const o=j.trans,{deleting:a,creating:l,updating:u}=o.table(e).hook;switch(i.type){case"add":if(l.fire===M)break;return o._promise("readwrite",()=>c(i),!0);case"put":if(l.fire===M&&u.fire===M)break;return o._promise("readwrite",()=>c(i),!0);case"delete":if(a.fire===M)break;return o._promise("readwrite",()=>c(i),!0);case"deleteRange":if(a.fire===M)break;return o._promise("readwrite",()=>function(d){return f(d.trans,d.range,1e4)}(i),!0)}return n.mutate(i);function c(d){const p=j.trans,m=d.keys||function(h,g){return g.type==="delete"?g.keys:g.keys||g.values.map(h.extractKey)}(r,d);if(!m)throw new Error("Keys missing");return(d=d.type==="add"||d.type==="put"?{...d,keys:m}:{...d}).type!=="delete"&&(d.values=[...d.values]),d.keys&&(d.keys=[...d.keys]),function(h,g,y){return g.type==="add"?Promise.resolve([]):h.getMany({trans:g.trans,keys:y,cache:"immutable"})}(n,d,m).then(h=>{const g=m.map((y,_)=>{const b=h[_],v={onerror:null,onsuccess:null};if(d.type==="delete")a.fire.call(v,y,b,p);else if(d.type==="add"||b===void 0){const k=l.fire.call(v,y,d.values[_],p);y==null&&k!=null&&(y=k,d.keys[_]=y,r.outbound||pe(d.values[_],r.keyPath,y))}else{const k=Sr(b,d.values[_]),w=u.fire.call(v,k,y,b,p);if(w){const x=d.values[_];Object.keys(w).forEach(T=>{ye(x,T)?x[T]=w[T]:pe(x,T,w[T])})}}return v});return n.mutate(d).then(({failures:y,results:_,numFailures:b,lastResult:v})=>{for(let k=0;k<m.length;++k){const w=_?_[k]:m[k],x=g[k];w==null?x.onerror&&x.onerror(y[k]):x.onsuccess&&x.onsuccess(d.type==="put"&&h[k]?d.values[k]:w)}return{failures:y,results:_,numFailures:b,lastResult:v}}).catch(y=>(g.forEach(_=>_.onerror&&_.onerror(y)),Promise.reject(y)))})}function f(d,p,m){return n.query({trans:d,values:!1,query:{index:r,range:p},limit:m}).then(({result:h})=>c({type:"delete",keys:h,trans:d}).then(g=>g.numFailures>0?Promise.reject(g.failures[0]):h.length<m?{failures:[],numFailures:0,lastResult:void 0}:f(d,{...p,lower:h[h.length-1],lowerOpen:!0},m)))}}}}})};function ti(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let s=0,i=0;s<e.keys.length&&i<t.length;++s)V(e.keys[s],t[i])===0&&(r.push(n?Ut(e.values[s]):e.values[s]),++i);return r.length===t.length?r:null}catch{return null}}const _o={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const s=ti(r.keys,r.trans._cache,r.cache==="clone");return s?S.resolve(s):n.getMany(r).then(i=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ut(i):i},i))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function Cr(t){return!("from"in t)}const Pe=function(t,e){if(!this){const n=new Pe;return t&&"d"in t&&oe(n,t),n}oe(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Ft(t,e,n){const r=V(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Cr(t))return oe(t,{from:e,to:n,d:1});const s=t.l,i=t.r;if(V(n,t.from)<0)return s?Ft(s,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Lr(t);if(V(e,t.to)>0)return i?Ft(i,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Lr(t);V(e,t.from)<0&&(t.from=e,t.l=null,t.d=i?i.d+1:1),V(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const o=!t.r;s&&!t.l&&vn(t,s),i&&o&&vn(t,i)}function vn(t,e){Cr(e)||function n(r,{from:s,to:i,l:o,r:a}){Ft(r,s,i),o&&n(r,o),a&&n(r,a)}(t,e)}function bo(t,e){const n=ir(e);let r=n.next();if(r.done)return!1;let s=r.value;const i=ir(t);let o=i.next(s.from),a=o.value;for(;!r.done&&!o.done;){if(V(a.from,s.to)<=0&&V(a.to,s.from)>=0)return!0;V(s.from,a.from)<0?s=(r=n.next(a.from)).value:a=(o=i.next(s.from)).value}return!1}function ir(t){let e=Cr(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&V(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||V(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Lr(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),s=r>1?"r":r<-1?"l":"";if(s){const i=s==="r"?"l":"r",o={...t},a=t[s];t.from=a.from,t.to=a.to,t[s]=a[s],o[s]=a[i],t[i]=o,o.d=Ur(o)}t.d=Ur(t)}function Ur({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}bt(Pe.prototype,{add(t){return vn(this,t),this},addKey(t){return Ft(this,t,t),this},addKeys(t){return t.forEach(e=>Ft(this,e,e)),this},[Mn](){return ir(this)}});const vo={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new Pe(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const s=t.table(r),{schema:i}=s,{primaryKey:o}=i,{extractKey:a,outbound:l}=o,u={...s,mutate:d=>{const p=d.trans,m=p.mutatedParts||(p.mutatedParts={}),h=w=>{const x=`idb://${e}/${r}/${w}`;return m[x]||(m[x]=new Pe)},g=h(""),y=h(":dels"),{type:_}=d;let[b,v]=d.type==="deleteRange"?[d.range]:d.type==="delete"?[d.keys]:d.values.length<50?[[],d.values]:[];const k=d.trans._cache;return s.mutate(d).then(w=>{if(te(b)){_!=="delete"&&(b=w.results),g.addKeys(b);const x=ti(b,k);x||_==="add"||y.addKeys(b),(x||v)&&function(T,$,N,U){function re(X){const W=T(X.name||"");function tt(ue){return ue!=null?X.extractKey(ue):null}const nt=ue=>X.multiEntry&&te(ue)?ue.forEach(We=>W.addKey(We)):W.addKey(ue);(N||U).forEach((ue,We)=>{const kt=N&&tt(N[We]),Sn=U&&tt(U[We]);V(kt,Sn)!==0&&(kt!=null&&nt(kt),Sn!=null&&nt(Sn))})}$.indexes.forEach(re)}(h,i,x,v)}else if(b){const x={from:b.lower,to:b.upper};y.add(x),g.add(x)}else g.add(n),y.add(n),i.indexes.forEach(x=>h(x.name).add(n));return w})}},c=({query:{index:d,range:p}})=>{var m,h;return[d,new Pe((m=p.lower)!==null&&m!==void 0?m:t.MIN_KEY,(h=p.upper)!==null&&h!==void 0?h:t.MAX_KEY)]},f={get:d=>[o,new Pe(d.key)],getMany:d=>[o,new Pe().addKeys(d.keys)],count:c,query:c,openCursor:c};return H(f).forEach(d=>{u[d]=function(p){const{subscr:m}=j;if(m){const h=v=>{const k=`idb://${e}/${r}/${v}`;return m[k]||(m[k]=new Pe)},g=h(""),y=h(":dels"),[_,b]=f[d](p);if(h(_.name||"").add(b),!_.isPrimaryKey){if(d!=="count"){const v=d==="query"&&l&&p.values&&s.query({...p,values:!1});return s[d].apply(this,arguments).then(k=>{if(d==="query"){if(l&&p.values)return v.then(({result:x})=>(g.addKeys(x),k));const w=p.values?k.result.map(a):k.result;p.values?g.addKeys(w):y.addKeys(w)}else if(d==="openCursor"){const w=k,x=p.values;return w&&Object.create(w,{key:{get:()=>(y.addKey(w.primaryKey),w.key)},primaryKey:{get(){const T=w.primaryKey;return y.addKey(T),T}},value:{get:()=>(x&&g.addKey(w.primaryKey),w.value)}})}return k})}y.add(n)}}return s[d].apply(this,arguments)}}),u}}}};class Je{constructor(e,n){this._middlewares={},this.verno=0;const r=Je.dependencies;this._options=n={addons:Je.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:M,dbReadyPromise:null,cancelOpen:M,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;i.dbReadyPromise=new S(a=>{i.dbReadyResolve=a}),i.openCanceller=new S((a,l)=>{i.cancelOpen=l}),this._state=i,this.name=e,this.on=At(this,"populate","blocked","versionchange","close",{ready:[vr,M]}),this.on.ready.subscribe=Os(this.on.ready.subscribe,a=>(l,u)=>{Je.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||S.resolve().then(l),u&&a(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&a(l);else{a(l);const f=this;u||a(function d(){f.on.ready.unsubscribe(l),f.on.ready.unsubscribe(d)})}})}),this.Collection=(o=this,Et(no.prototype,function(a,l){this.db=o;let u=Gs,c=null;if(l)try{u=l()}catch(m){c=m}const f=a._ctx,d=f.table,p=d.hook.reading.fire;this._ctx={table:d,index:f.index,isPrimKey:!f.index||d.schema.primKey.keyPath&&f.index===d.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:f.or,valueMapper:p!==It?p:null}})),this.Table=function(a){return Et(to.prototype,function(l,u,c){this.db=a,this._tx=c,this.name=l,this.schema=u,this.hook=a._allTables[l]?a._allTables[l].hook:At(null,{creating:[Li,M],reading:[qi,It],updating:[Wi,M],deleting:[Ui,M]})})}(this),this.Transaction=function(a){return Et(oo.prototype,function(l,u,c,f,d){this.db=a,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=At(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new S((p,m)=>{this._resolve=p,this._reject=m}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},p=>{var m=this.active;return this.active=!1,this.on.error.fire(p),this.parent?this.parent._reject(p):m&&this.idbtrans&&this.idbtrans.abort(),J(p)})})}(this),this.Version=function(a){return Et(fo.prototype,function(l){this.db=a,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return Et(Js.prototype,function(l,u,c){if(this.db=a,this._ctx={table:l,index:u===":id"?null:u,or:c},this._cmp=this._ascending=V,this._descending=(f,d)=>V(d,f),this._max=(f,d)=>V(f,d)>0?f:d,this._min=(f,d)=>V(f,d)<0?f:d,this._IDBKeyRange=a._deps.IDBKeyRange,!this._IDBKeyRange)throw new B.MissingAPI})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=Mt(n.IDBKeyRange),this._createTransaction=(a,l,u,c)=>new this.Transaction(a,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=a=>{this.on("blocked").fire(a),Ot.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(a))},this.use(yo),this.use(go),this.use(vo),this.use(_o),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new B.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(s=>s._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(uo),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||j.letThrough||this._vip)?e():new S((n,r)=>{if(this._state.openComplete)return r(new B.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new B.DatabaseClosed);this.open().catch(M)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:s}){s&&this.unuse({stack:e,name:s});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:n,level:r??10,name:s}),i.sort((o,a)=>o.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(s=>r?s.create!==r:!!n&&s.name!==n)),this}open(){return po(this)}_close(){const e=this._state,n=Ot.indexOf(this);if(n>=0&&Ot.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new S(r=>{e.dbReadyResolve=r}),e.openCanceller=new S((r,s)=>{e.cancelOpen=s})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new B.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new S((r,s)=>{const i=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=L(()=>{(function({indexedDB:a,IDBKeyRange:l},u){!$r(a)&&u!=="__dbnames"&&Er(a,l).delete(u).catch(M)})(this._deps,this.name),r()}),o.onerror=be(s),o.onblocked=this._fireOnBlocked};if(e)throw new B.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return H(this._allTables).map(e=>this._allTables[e])}transaction(){const e=mo.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let s=j.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);const i=e.indexOf("?")!==-1;let o,a;e=e.replace("!","").replace("?","");try{if(a=n.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e==="readonly")o="readonly";else{if(e!="rw"&&e!="readwrite")throw new B.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(s){if(s.mode==="readonly"&&o==="readwrite"){if(!i)throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&a.forEach(u=>{if(s&&s.storeNames.indexOf(u)===-1){if(!i)throw new B.SubTransaction("Table "+u+" not included in parent transaction.");s=null}}),i&&s&&!s.active&&(s=null)}}catch(u){return s?s._promise(null,(c,f)=>{f(u)}):J(u)}const l=ei.bind(null,this,o,a,s,r);return s?s._promise(o,l,"lock"):j.trans?wt(j.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!ye(this._allTables,e))throw new B.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const wo=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class ko{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[wo](){return this}}function ni(t,e){return H(e).forEach(n=>{vn(t[n]||(t[n]=new Pe),e[n])}),t}let wn;try{wn={indexedDB:F.indexedDB||F.mozIndexedDB||F.webkitIndexedDB||F.msIndexedDB,IDBKeyRange:F.IDBKeyRange||F.webkitIDBKeyRange}}catch{wn={indexedDB:null,IDBKeyRange:null}}function xo(t){return new ko(e=>{const n=gr(t);let r=!1,s={},i={};const o={get closed(){return r},unsubscribe:()=>{r=!0,Le.storagemutated.unsubscribe(c)}};e.start&&e.start(o);let a=!1,l=!1;function u(){return H(i).some(d=>s[d]&&bo(s[d],i[d]))}const c=d=>{ni(s,d),u()&&f()},f=()=>{if(a||r||!wn.indexedDB)return;s={};const d={},p=function(m){n&&vt();const h=()=>Fe(t,{subscr:m,trans:null}),g=j.trans?wt(j.transless,h):h();return n&&g.then(je,je),g}(d);l||(Le("storagemutated",c),l=!0),a=!0,Promise.resolve(p).then(m=>{a=!1,r||(u()?f():(s={},i=d,e.next&&e.next(m)))},m=>{["DatabaseClosedError","AbortError"].includes(m?.name)||(a=!1,e.error&&e.error(m),o.unsubscribe())})};return f(),o})}const Ve=Je;function ln(t){let e=Ae;try{Ae=!0,Le.storagemutated.fire(t)}finally{Ae=e}}bt(Ve,{...tn,delete:t=>new Ve(t,{addons:[]}).delete(),exists:t=>new Ve(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return $r(e)?Promise.resolve(e.databases()).then(r=>r.map(s=>s.name).filter(s=>s!=="__dbnames")):Er(e,n).toCollection().primaryKeys()}(Ve.dependencies).then(t)}catch{return J(new B.MissingAPI)}},defineClass:()=>function(t){oe(this,t)},ignoreTransaction:t=>j.trans?wt(j.transless,t):t(),vip:rr,async:function(t){return function(){try{var e=sr(t.apply(this,arguments));return e&&typeof e.then=="function"?e:S.resolve(e)}catch(n){return J(n)}}},spawn:function(t,e,n){try{var r=sr(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:S.resolve(r)}catch(s){return J(s)}},currentTransaction:{get:()=>j.trans||null},waitFor:function(t,e){const n=S.resolve(typeof t=="function"?Ve.ignoreTransaction(t):t).timeout(e||6e4);return j.trans?j.trans.waitFor(n):n},Promise:S,debug:{get:()=>Se,set:t=>{Ds(t,t==="dexie"?()=>!0:zs)}},derive:ht,extend:oe,props:bt,override:Os,Events:At,on:Le,liveQuery:xo,extendObservabilitySet:ni,getByKeyPath:Ke,setByKeyPath:pe,delByKeyPath:function(t,e){typeof e=="string"?pe(t,e,void 0):"length"in e&&[].map.call(e,function(n){pe(t,n,void 0)})},shallowClone:Ks,deepClone:Ut,getObjectDiff:Sr,cmp:V,asap:As,minKey:-(1/0),addons:[],connections:Ot,errnames:br,dependencies:wn,semVer:"4.0.1-alpha.10",version:"4.0.1-alpha.10".split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Ve.maxKey=Mt(Ve.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Le("storagemutated",t=>{if(!Ae){let e;$n?(e=document.createEvent("CustomEvent"),e.initCustomEvent("x-storagemutated-1",!0,!0,t)):e=new CustomEvent("x-storagemutated-1",{detail:t}),Ae=!0,dispatchEvent(e),Ae=!1}}),addEventListener("x-storagemutated-1",({detail:t})=>{Ae||ln(t)}));let Ae=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel("x-storagemutated-1");typeof t.unref=="function"&&t.unref(),Le("storagemutated",e=>{Ae||t.postMessage(e)}),t.onmessage=e=>{e.data&&ln(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Le("storagemutated",e=>{try{Ae||(typeof localStorage<"u"&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:"x-storagemutated-1",changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key==="x-storagemutated-1"){const n=JSON.parse(e.newValue);n&&ln(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type==="x-storagemutated-1"&&ln(e.changedParts)})}S.rejectionMapper=function(t,e){if(!t||t instanceof pt||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Br[t.name])return t;var n=new Br[t.name](e||t.message,t);return"stack"in t&&Te(n,"stack",{get:function(){return this.inner.stack}}),n},Ds(Se,zs);class Eo extends Je{tags;todos;constructor(){super("helloworldtodos"),this.version(2).stores({tags:"&key",todos:"++id,*tags"})}}const un=new Eo,ot=[];function De(t,e=R){let n;const r=new Set;function s(a){if(ne(t,a)&&(t=a,n)){const l=!ot.length;for(const u of r)u[1](),ot.push(u,t);if(l){for(let u=0;u<ot.length;u+=2)ot[u][0](ot[u+1]);ot.length=0}}}function i(a){s(a(t))}function o(a,l=R){const u=[a,l];return r.add(u),r.size===1&&(n=e(s)||R),a(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}class $o{add(e,n,...r){return new Promise((s,i)=>{this.queue.push({c:e,f:n,a:r,r:s,e:i}),this.run()})}constructor(){this.job=void 0,this.queue=[]}run(){this.job||(this.job=this.queue.shift(),this.job&&this.job.f.apply(this.job.c,this.job.a).then(this.job.r).catch(this.job.e).finally(()=>{this.job=void 0,setTimeout(()=>this.run(),0)}))}}const ve=De(),yt=De(localStorage.getItem("haslock")!=null);class jn{_data={};constructor(e,n){this._data=n;const{set:r,subscribe:s,update:i}=De(n);this.table=e,this.parset=r,this.subscribe=s}async set(e){await this.table.update(e),this.parset(e)}get data(){return this._data}set data(e){this._data=e,this.set(this._data)}setDataNoWrite(e){this._data=e,this.parset(e)}refresh(){this.set(this._data)}}class ri{dataset=new Map;queue=new $o;table;keyName="";lockkey=void 0;autoIncrement=!1;async validateDrop(){return!0}async afterDrop(){}async afterUpdate(){}async onLockUnlock(){}async lockDataSet(e){return e}async unlockDataSet(e){return e}constructor(e,n){this.table=e,n.idField&&(this.keyName=n.idField),n.autoIncrement&&(this.autoInrement=!0),ve.subscribe(r=>{this.lockkey=r,this.dataset.clear(),this.onLockUnlock(r)})}async findByPK(e,n){const r=new Error("").stack;return await this.queue.add(this,s=>this.table.get(s).then(async i=>{if(!i){console.warn(`Request for pk '${s}' on table '${this.table.name}' resulted in no data for call `,r);return}if(this.dataset.has(e))return this.dataset.get(e),this.dataset.get(e);if(this.lockkey){const o=await this.unlockDataSet(i,this.lockkey),a=new jn(this,o);return this.dataset.set(s,a),a}else{const o=new jn(this,i);return this.dataset.set(s,o),Promise.resolve(o)}}),e)}async update(e){if(!e[this.keyName])throw new Error(`given data is missing field ${this.keyName}`);const n=e[this.keyName],r=await this.findByPK(n);if(r){let s=r.data;for(let i of Object.keys(s))s[i]=e[i];r.setDataNoWrite(s)}if(await this.table.put(this.lockkey?await this.lockDataSet({...e},this.lockkey):e)){this.dataset.delete(n);const s=await this.findByPK(n);return await this.afterUpdate(s),s}else throw new Error("failed to insert data")}async drop(e){console.log(e),e instanceof jn||(e=await this.findByPK(e)),console.log(e);const n=e.data[this.keyName];await this.validateDrop(e)&&(await this.table.delete(n),await this.afterDrop(e))}async encryptAll(e,n){this.table.db.transaction("rw",this.table,async()=>{await this.table.each(async r=>{n&&(r=await this.unlockDataSet(r,n)),e&&(r=await this.lockDataSet(r,e)),this.table.put(r)})})}async toArray(e){const n=[];return await this.table.db.transaction("r",this.table,async()=>{await this.table.each(async r=>{e&&(r=await this.unlockDataSet(r,e)),n.push(r)})}),n}}function si(t,e=!1){return e?crypto.subtle.digest("SHA-256",new TextEncoder().encode(t)).then(n=>{const r=new Uint8Array(n);let s="";for(let i=0;i<r.length;i++)s+=r[i].toString(16).padStart(2,"0");return s}):crypto.subtle.digest("SHA-256",new TextEncoder().encode(t))}function So(t){return crypto.subtle.importKey("raw",t,"AES-GCM",!1,["encrypt","decrypt"])}function Co(){return crypto.randomUUID()}class Ze{data;iv;static fromBase64(e){return Ze.fromUint8Array(new Uint8Array(oi(e||"")))}static fromUint8Array(e){if(e.length<32)throw new Error("the given array does not seem to contain encrypted data (min length: 32)");const n=new Uint8Array(16),r=new Uint8Array(e.length-16);for(let s=0;s<16;s++)n[s]=e[s];for(let s=16,i=0;s<e.length;s++,i++)r[i]=e[s];return new Ze({iv:n,data:r})}constructor(e){this.data=e.data,this.iv=e.iv}toUint8Array(){const e=this.iv.length,n=this.data.length,r=new Uint8Array(e+n);for(let s=0;s<e;s++)r[s]=this.iv[s];for(let s=0,i=e;s<n;s++,i++)r[i]=this.data[s];return r}toBase64(){return ii(this.toUint8Array())}}function Ht(t){return si(t).then(e=>So(e))}async function Po(t,e){const n=e instanceof CryptoKey?e:await Ht(e),r=new Uint8Array(16);return await crypto.getRandomValues(r),new Ze({iv:r,data:new Uint8Array(await crypto.subtle.encrypt({name:"AES-GCM",length:2048,iv:r},n,t))})}async function Oo(t,e){if(!t)return;const n=e instanceof CryptoKey?e:await Ht(e);return await crypto.subtle.decrypt({name:"AES-GCM",length:2048,iv:t.iv},n,t.data)}function ii(t){if(typeof Buffer<"u")return Buffer.from(t).toString("base64");{let e="";const n=new Uint8Array(t),r=n.byteLength;for(let s=0;s<r;s++)e+=String.fromCharCode(n[s]);return btoa(e)}}function oi(t){if(typeof Buffer<"u")return Buffer.from(t,"base64");{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return r.buffer}}const ai={encrypt:ii,decrypt:oi},Pr={encrypt:Po,decrypt:Oo},Kt={sha256:si,uuid:Co,password2CryptoKey:Ht,synckey:Pr,base64:ai};class Ao extends ri{valuesStore=De([]);async lockDataSet(e,n){if(e.data)throw new Error("Data is already locked :-( ");return e.data=(await Kt.synckey.encrypt(new TextEncoder().encode(JSON.stringify({value:e.value,color:e.color,version:e.version})),n)).toBase64(),e.value="encrypted tag",e.color="#000000",e.version=999999999,e}async unlockDataSet(e,n){if(!e.data)return e;let r=JSON.parse(new TextDecoder().decode(await Kt.synckey.decrypt(Ze.fromBase64(e.data),n)));return e.value=r.value,e.color=r.color,e.version=r.version,delete e.data,e}async afterUpdate(e){this.valuesStore.update(n=>(e.data.value&&n.indexOf(e.data.value)==-1&&n.push(e.data.value),n))}async afterDrop(e){this.valuesStore.update(n=>{let r=n.indexOf(e.data.value);return r!=-1&&n.splice(r,1),n})}onLockUnlock(e){return this.updateValues(e)}constructor(){super(un.tags,{idField:"key"}),this.updateValues()}definePKByValue(e){let n=e.trim().toLowerCase();if(n=="")throw Error("cant define key for empty value");return Kt.sha256(n,!0)}get values(){return this.valuesStore}updateValues(e){const n=[];return this.table.toCollection().each(async r=>{r.data?e&&n.push((await this.unlockDataSet(r,e)).value):n.push(r.value)}).then(()=>{this.valuesStore.set(n)})}}const xe=new Ao;function Wr(t,e,n){const r=t.slice();return r[2]=e[n],r}function Vr(t){let e,n;return{c(){e=O("option"),e.__value=n=t[2],e.value=e.__value},m(r,s){A(r,e,s)},p(r,s){s&1&&n!==(n=r[2])&&(e.__value=n,e.value=e.__value)},d(r){r&&P(e)}}}function To(t){let e,n=t[0],r=[];for(let s=0;s<n.length;s+=1)r[s]=Vr(Wr(t,n,s));return{c(){e=O("datalist");for(let s=0;s<r.length;s+=1)r[s].c();E(e,"id","available_tags")},m(s,i){A(s,e,i);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(s,[i]){if(i&1){n=s[0];let o;for(o=0;o<n.length;o+=1){const a=Wr(s,n,o);r[o]?r[o].p(a,i):(r[o]=Vr(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},i:R,o:R,d(s){s&&P(e),ur(r,s)}}}function Ko(t,e,n){let r;const s=xe.values;return ee(t,s,i=>n(0,r=i)),[r,s]}class jo extends le{constructor(e){super(),ae(this,e,Ko,To,ne,{})}}function Or(t){const e=t-1;return e*e*e+1}function Bo(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Hr(t,{delay:e=0,duration:n=400,easing:r=qt}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:i=>`opacity: ${i*s}`}}function _e(t,{delay:e=0,duration:n=400,easing:r=Or,axis:s="y"}={}){const i=getComputedStyle(t),o=+i.opacity,a=s==="y"?"height":"width",l=parseFloat(i[a]),u=s==="y"?["top","bottom"]:["left","right"],c=u.map(y=>`${y[0].toUpperCase()}${y.slice(1)}`),f=parseFloat(i[`padding${c[0]}`]),d=parseFloat(i[`padding${c[1]}`]),p=parseFloat(i[`margin${c[0]}`]),m=parseFloat(i[`margin${c[1]}`]),h=parseFloat(i[`border${c[0]}Width`]),g=parseFloat(i[`border${c[1]}Width`]);return{delay:e,duration:n,easing:r,css:y=>`overflow: hidden;opacity: ${Math.min(y*20,1)*o};${a}: ${y*l}px;padding-${u[0]}: ${y*f}px;padding-${u[1]}: ${y*d}px;margin-${u[0]}: ${y*p}px;margin-${u[1]}: ${y*m}px;border-${u[0]}-width: ${y*h}px;border-${u[1]}-width: ${y*g}px;`}}function Do(t){var{fallback:e}=t,n=Bo(t,["fallback"]);const r=new Map,s=new Map;function i(a,l,u){const{delay:c=0,duration:f=x=>Math.sqrt(x)*30,easing:d=Or}=Bn(Bn({},n),u),p=a.getBoundingClientRect(),m=l.getBoundingClientRect(),h=p.left-m.left,g=p.top-m.top,y=p.width/m.width,_=p.height/m.height,b=Math.sqrt(h*h+g*g),v=getComputedStyle(l),k=v.transform==="none"?"":v.transform,w=+v.opacity;return{delay:c,duration:Ue(f)?f(b):f,easing:d,css:(x,T)=>`
				opacity: ${x*w};
				transform-origin: top left;
				transform: ${k} translate(${T*h}px,${T*g}px) scale(${x+(1-x)*y}, ${x+(1-x)*_});
			`}}function o(a,l,u){return(c,f)=>(a.set(f.key,c),()=>{if(l.has(f.key)){const d=l.get(f.key);return l.delete(f.key),i(d,c,f)}return a.delete(f.key),e&&e(c,f,u)})}return[o(s,r,!1),o(r,s,!0)]}function zr(t){let e,n,r;function s(l,u){return l[1]?Ro:Io}let i=s(t),o=i(t),a=!t[0]&&Gr(t);return{c(){e=O("span"),o.c(),n=I(),a&&a.c(),E(e,"class","tag svelte-1law4as"),E(e,"style",r=`--tagcolor: ${t[3].color}`)},m(l,u){A(l,e,u),o.m(e,null),C(e,n),a&&a.m(e,null)},p(l,u){i===(i=s(l))&&o?o.p(l,u):(o.d(1),o=i(l),o&&(o.c(),o.m(e,n))),l[0]?a&&(a.d(1),a=null):a?a.p(l,u):(a=Gr(l),a.c(),a.m(e,null)),u&8&&r!==(r=`--tagcolor: ${l[3].color}`)&&E(e,"style",r)},d(l){l&&P(e),o.d(),a&&a.d()}}}function Io(t){let e,n=t[3].value+"",r,s,i;return{c(){e=O("a"),r=ge(n),E(e,"href","#"),E(e,"class","svelte-1law4as")},m(o,a){A(o,e,a),C(e,r),s||(i=q(e,"click",Y(t[6])),s=!0)},p(o,a){a&8&&n!==(n=o[3].value+"")&&Lt(r,n)},d(o){o&&P(e),s=!1,i()}}}function Ro(t){let e=t[3].value+"",n;return{c(){n=ge(e)},m(r,s){A(r,n,s)},p(r,s){s&8&&e!==(e=r[3].value+"")&&Lt(n,e)},d(r){r&&P(n)}}}function Gr(t){let e,n,r;return{c(){e=O("a"),e.textContent="",E(e,"href","#"),E(e,"class","fa fa-times svelte-1law4as")},m(s,i){A(s,e,i),n||(r=q(e,"click",Y(t[7])),n=!0)},p:R,d(s){s&&P(e),n=!1,r()}}}function No(t){let e,n=t[3]&&zr(t);return{c(){n&&n.c(),e=Be()},m(r,s){n&&n.m(r,s),A(r,e,s)},p(r,[s]){r[3]?n?n.p(r,s):(n=zr(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:R,o:R,d(r){n&&n.d(r),r&&P(e)}}}function Mo(t,e,n){let r,s=R,i=()=>(s(),s=kn(u,p=>n(3,r=p)),u);t.$$.on_destroy.push(()=>s());let{key:o=""}=e,{noremove:a=!1}=e,{noclick:l=!1}=e,u;const c=$s(),f=()=>c("click",u),d=()=>c("remove",u);return t.$$set=p=>{"key"in p&&n(5,o=p.key),"noremove"in p&&n(0,a=p.noremove),"noclick"in p&&n(1,l=p.noclick)},t.$$.update=()=>{t.$$.dirty&32&&xe.findByPK(o).then(p=>i(n(2,u=p)))},[a,l,u,r,c,o,f,d]}class li extends le{constructor(e){super(),ae(this,e,Mo,No,ne,{key:5,noremove:0,noclick:1})}}function Yr(t,e,n){const r=t.slice();return r[3]=e[n],r}function Jr(t,e){let n,r=e[3].msg+"",s,i,o,a,l;return{key:t,first:null,c(){n=O("article"),s=ge(r),i=I(),E(n,"class",o=Tr(e[3].cssClass)+" svelte-1e5twis"),this.first=n},m(u,c){A(u,n,c),C(n,s),C(n,i),l=!0},p(u,c){e=u,(!l||c&1)&&r!==(r=e[3].msg+"")&&Lt(s,r),(!l||c&1&&o!==(o=Tr(e[3].cssClass)+" svelte-1e5twis"))&&E(n,"class",o)},i(u){l||(fe(()=>{l&&(a||(a=$e(n,_e,{duration:250},!0)),a.run(1))}),l=!0)},o(u){a||(a=$e(n,_e,{duration:250},!1)),a.run(0),l=!1},d(u){u&&P(n),u&&a&&a.end()}}}function Fo(t){let e,n=[],r=new Map,s,i=t[0];const o=a=>a[3].id;for(let a=0;a<i.length;a+=1){let l=Yr(t,i,a),u=o(l);r.set(u,n[a]=Jr(u,l))}return{c(){e=O("div");for(let a=0;a<n.length;a+=1)n[a].c();E(e,"class","toastcontainer svelte-1e5twis")},m(a,l){A(a,e,l);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(e,null);s=!0},p(a,[l]){l&1&&(i=a[0],se(),n=In(n,l,o,1,a,i,r,e,Cs,Jr,null,Yr),ie())},i(a){if(!s){for(let l=0;l<i.length;l+=1)K(n[l]);s=!0}},o(a){for(let l=0;l<n.length;l+=1)D(n[l]);s=!1},d(a){a&&P(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}let qo=1;const or=De([]);function ce(t,e,n=4){or.update(r=>(r.push({id:qo++,msg:t,cssClass:e,timeout:n*10}),r))}function Lo(t,e,n){let r;ee(t,or,o=>n(0,r=o));let s;function i(){!s&&r.length&&(s=window.setTimeout(()=>{r.forEach(o=>o.timeout--),ct(or,r=r.filter(o=>o.timeout>0),r),s=void 0,i()},100))}return t.$$.update=()=>{t.$$.dirty&1&&r.length&&i()},[r]}class Uo extends le{constructor(e){super(),ae(this,e,Lo,Fo,ne,{})}}const Ee=De([]);try{let t=localStorage.getItem("tagfilter");t&&(t=JSON.parse(t)),t instanceof Array&&Ee.set(t)}catch{console.warn("failed to load taglist from localStorage"),localStorage.removeItem("tagfilter")}Ee.subscribe(t=>localStorage.setItem("tagfilter",JSON.stringify(t)));class Wo extends ri{lastFilter=[];_store=De([]);async afterDrop(e){this._store.update(n=>n.filter(r=>r.data.id!=e.data.id))}constructor(){super(un.todos,{idField:"id"})}async onLockUnlock(){this.filterStore(this.lastFilter)}async lockDataSet(e,n){if(e.data)throw new Error("Data is already locked :-( ");return e.data=(await Kt.synckey.encrypt(new TextEncoder().encode(JSON.stringify({description:e.description,done:e.done,tags:e.tags})),n)).toBase64(),e.description="encrypted todo",e.done=!1,e}async unlockDataSet(e,n){if(!e.data)return e;let r=JSON.parse(new TextDecoder().decode(await Kt.synckey.decrypt(Ze.fromBase64(e.data),n)));return e.description=r.description,e.done=r.done,delete e.data,e}async dropTag(e){await un.todos.toCollection().modify(n=>{const r=n.tags.indexOf(e);r!==-1&&n.tags.splice(r,1)}),this._store.update(n=>(n.forEach(r=>{let s=r.data,i=s.tags.indexOf(e);i>-1&&(s.tags.splice(i,1),r.data=s)}),n))}async filterStore(e){this.lastFilter=e||[];let n=un.todos;this.lastFilter.length?(n=n.where("id").anyOf(await n.where("tags").anyOf(this.lastFilter).primaryKeys()),this.lastFilter.length>1&&(n=n.and(i=>{let o=!0;for(let a=0;a<e.length;a++)if(i.tags.indexOf(e[a])==-1){o=!1;break}return o}))):n=n.toCollection();const r=await n.primaryKeys(),s=await Promise.all(r.map(i=>this.findByPK(i)));this._store.set(s)}refreshView(){this.filterStore(this.lastFilter)}async insert(e){e.id=Date.now()*1e3+Math.floor(Math.random()*800+100);const n=await this.update(e);this._store.update(r=>(r.push(n),r))}get store(){return this._store}}const me=new Wo;Ee.subscribe(t=>{me.filterStore(t)});function Qr(t){let e,n,r,s,i,o,a,l,u,c,f,d,p,m,h,g,y,_,b,v,k,w,x,T;return{c(){e=O("section"),n=O("label"),n.textContent="Key:",r=I(),s=O("input"),o=I(),a=O("button"),l=I(),u=O("label"),u.textContent="Value:",c=I(),f=O("input"),p=I(),m=O("label"),m.textContent="Color:",h=I(),g=O("input"),y=I(),_=O("button"),_.textContent="close",b=I(),v=O("button"),v.textContent="save",E(n,"for","tagedit_key_input"),E(s,"id","tagedit_key_input"),E(s,"type","text"),s.value=i=t[0].data.key,s.disabled=!0,E(a,"class","fa fa-trash-can"),E(a,"title","delete"),E(u,"for","tagedit_value_input"),E(f,"id","tagedit_value_input"),E(f,"type","text"),f.value=d=t[0].data.value,f.disabled=!0,E(f,"class","svelte-1hd6fid"),E(m,"for","tagedit_value_input"),E(g,"id","tagedit_value_input"),E(g,"type","color"),E(g,"class","svelte-1hd6fid"),E(_,"id","tagedit_close_btn"),E(v,"id","tagedit_save_btn"),E(v,"class","svelte-1hd6fid"),E(e,"class","svelte-1hd6fid")},m($,N){A($,e,N),C(e,n),C(e,r),C(e,s),C(e,o),C(e,a),C(e,l),C(e,u),C(e,c),C(e,f),C(e,p),C(e,m),C(e,h),C(e,g),Me(g,t[0].data.color),C(e,y),C(e,_),C(e,b),C(e,v),w=!0,x||(T=[q(a,"click",Y(t[3])),q(g,"input",t[4]),q(_,"click",Y(t[5])),q(v,"click",Y(t[2]))],x=!0)},p($,N){(!w||N&1&&i!==(i=$[0].data.key)&&s.value!==i)&&(s.value=i),(!w||N&1&&d!==(d=$[0].data.value)&&f.value!==d)&&(f.value=d),N&1&&Me(g,$[0].data.color)},i($){w||(fe(()=>{w&&(k||(k=$e(e,_e,{},!0)),k.run(1))}),w=!0)},o($){k||(k=$e(e,_e,{},!1)),k.run(0),w=!1},d($){$&&P(e),$&&k&&k.end(),x=!1,de(T)}}}function Vo(t){let e,n,r=t[0]&&Qr(t);return{c(){r&&r.c(),e=Be()},m(s,i){r&&r.m(s,i),A(s,e,i),n=!0},p(s,[i]){s[0]?r?(r.p(s,i),i&1&&K(r,1)):(r=Qr(s),r.c(),K(r,1),r.m(e.parentNode,e)):r&&(se(),D(r,1,1,()=>{r=null}),ie())},i(s){n||(K(r),n=!0)},o(s){D(r),n=!1},d(s){r&&r.d(s),s&&P(e)}}}let Ne=De();function Ho(t,e,n){let r,s=R;ee(t,Ne,c=>n(0,r=c)),t.$$.on_destroy.push(()=>s());const i=async()=>{r&&confirm("deleting the tag here, will remove it from all Todos too. This step can not be undone! Continue?")&&(await me.dropTag(r.data.key),await xe.drop(r),Ee.update(c=>c.filter(f=>f!=r.data.key)),ct(Ne,r=void 0,r),ce("tag removed","info",2))},o=async()=>{r.refresh(),ct(Ne,r=void 0,r),ce("changes saved","success",2)},a=()=>i();function l(){r.data.color=this.value,Ne.set(r)}return[r,i,o,a,l,()=>ct(Ne,r=void 0,r)]}class zo extends le{constructor(e){super(),ae(this,e,Ho,Vo,ne,{})}}function Xr(t){let e,n,r,s,i,o,a,l;return{c(){e=O("form"),n=O("input"),r=I(),s=O("button"),E(n,"type","text"),E(n,"list","available_tags"),E(n,"autocomplete",""),E(s,"type","submit"),E(s,"class","fa fa-plus-circle svelte-b6n156"),E(e,"class","taginput svelte-b6n156"),we(e,"open",t[1])},m(u,c){A(u,e,c),C(e,n),Me(n,t[0]),C(e,r),C(e,s),o=!0,a||(l=[q(n,"input",t[4]),q(e,"submit",Y(t[2]))],a=!0)},p(u,c){c&1&&n.value!==u[0]&&Me(n,u[0]),(!o||c&2)&&we(e,"open",u[1])},i(u){o||(fe(()=>{o&&(i||(i=$e(e,_e,{},!0)),i.run(1))}),o=!0)},o(u){i||(i=$e(e,_e,{},!1)),i.run(0),o=!1},d(u){u&&P(e),u&&i&&i.end(),a=!1,de(l)}}}function Go(t){let e,n,r=t[1]&&Xr(t);return{c(){r&&r.c(),e=Be()},m(s,i){r&&r.m(s,i),A(s,e,i),n=!0},p(s,[i]){s[1]?r?(r.p(s,i),i&2&&K(r,1)):(r=Xr(s),r.c(),K(r,1),r.m(e.parentNode,e)):r&&(se(),D(r,1,1,()=>{r=null}),ie())},i(s){n||(K(r),n=!0)},o(s){D(r),n=!1},d(s){r&&r.d(s),s&&P(e)}}}function Yo(t,e,n){const r=$s();let{visible:s=!0}=e,{value:i=""}=e,{noautocreate:o=!1}=e;const a=async()=>{let u;try{u=await xe.definePKByValue(i)}catch{ce("can't submit an empty Tag","alert",2);return}let c=await xe.findByPK(u);if(!c){if(o){ce("tag is unknown","alert",2);return}const f={key:u,value:i,color:"#73828c"};c=await xe.update(f)}r("submit",c),n(0,i="")};function l(){i=this.value,n(0,i)}return t.$$set=u=>{"visible"in u&&n(1,s=u.visible),"value"in u&&n(0,i=u.value),"noautocreate"in u&&n(3,o=u.noautocreate)},[i,s,a,o,l]}class ui extends le{constructor(e){super(),ae(this,e,Yo,Go,ne,{visible:1,value:0,noautocreate:3})}}function Zr(t,e,n){const r=t.slice();return r[9]=e[n],r}function es(t){let e,n,r,s,i,o,a,l,u;e=new ui({}),e.$on("submit",t[4]),r=new zo({});const c=[Qo,Jo],f=[];function d(p,m){return p[0].length?0:1}return o=d(t),a=f[o]=c[o](t),{c(){Q(e.$$.fragment),n=I(),Q(r.$$.fragment),s=I(),i=O("section"),a.c(),E(i,"class","taglist svelte-n6f67g"),we(i,"open",t[1])},m(p,m){z(e,p,m),A(p,n,m),z(r,p,m),A(p,s,m),A(p,i,m),f[o].m(i,null),u=!0},p(p,m){let h=o;o=d(p),o===h?f[o].p(p,m):(se(),D(f[h],1,1,()=>{f[h]=null}),ie(),a=f[o],a?a.p(p,m):(a=f[o]=c[o](p),a.c()),K(a,1),a.m(i,null)),(!u||m&2)&&we(i,"open",p[1])},i(p){u||(K(e.$$.fragment,p),K(r.$$.fragment,p),K(a),fe(()=>{u&&(l||(l=$e(i,_e,{},!0)),l.run(1))}),u=!0)},o(p){D(e.$$.fragment,p),D(r.$$.fragment,p),D(a),l||(l=$e(i,_e,{},!1)),l.run(0),u=!1},d(p){G(e,p),p&&P(n),G(r,p),p&&P(s),p&&P(i),f[o].d(),p&&l&&l.end()}}}function Jo(t){let e;return{c(){e=ge("No Tags yet")},m(n,r){A(n,e,r)},p:R,i:R,o:R,d(n){n&&P(e)}}}function Qo(t){let e,n,r=t[0],s=[];for(let o=0;o<r.length;o+=1)s[o]=ts(Zr(t,r,o));const i=o=>D(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=Be()},m(o,a){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,a);A(o,e,a),n=!0},p(o,a){if(a&13){r=o[0];let l;for(l=0;l<r.length;l+=1){const u=Zr(o,r,l);s[l]?(s[l].p(u,a),K(s[l],1)):(s[l]=ts(u),s[l].c(),K(s[l],1),s[l].m(e.parentNode,e))}for(se(),l=r.length;l<s.length;l+=1)i(l);ie()}},i(o){if(!n){for(let a=0;a<r.length;a+=1)K(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);n=!1},d(o){ur(s,o),o&&P(e)}}}function ts(t){let e,n;return e=new li({props:{key:t[9]}}),e.$on("remove",t[3]),e.$on("click",t[8]),{c(){Q(e.$$.fragment)},m(r,s){z(e,r,s),n=!0},p(r,s){const i={};s&1&&(i.key=r[9]),e.$set(i)},i(r){n||(K(e.$$.fragment,r),n=!0)},o(r){D(e.$$.fragment,r),n=!1},d(r){G(e,r)}}}function Xo(t){let e,n,r,s,i,o,a=t[1]&&es(t);return{c(){e=O("a"),e.textContent="Tags",n=I(),a&&a.c(),r=Be(),E(e,"role","button"),E(e,"href","#"),E(e,"class","svelte-n6f67g")},m(l,u){A(l,e,u),A(l,n,u),a&&a.m(l,u),A(l,r,u),s=!0,i||(o=q(e,"click",Y(t[7])),i=!0)},p(l,[u]){l[1]?a?(a.p(l,u),u&2&&K(a,1)):(a=es(l),a.c(),K(a,1),a.m(r.parentNode,r)):a&&(se(),D(a,1,1,()=>{a=null}),ie())},i(l){s||(K(a),s=!0)},o(l){D(a),s=!1},d(l){l&&P(e),l&&P(n),a&&a.d(l),l&&P(r),i=!1,o()}}}function Zo(t,e,n){let r,s,i,o,a;ee(t,Ee,d=>n(0,s=d)),ee(t,ve,d=>n(5,i=d)),ee(t,yt,d=>n(6,o=d)),ee(t,Ne,d=>n(2,a=d));function l(d){const p=d?.detail?.data?.key,m=s.indexOf(p);m>-1&&(s.splice(m,1),Ee.set(s))}function u(d){const p=d?.detail?.data?.key;p&&s.indexOf(p)==-1?(s.push(p),Ee.set(s)):console.error("missing key",d,p)}const c=()=>n(1,r=!r),f=d=>{Ne.set(Ne&&a==d.detail?void 0:d.detail)};return t.$$.update=()=>{t.$$.dirty&97&&n(1,r=o&&!i?!1:s.length>0)},[s,r,a,l,u,i,o,c,f]}class ea extends le{constructor(e){super(),ae(this,e,Zo,Xo,ne,{})}}function ta(t){let e,n,r,s,i,o,a;return{c(){e=O("div"),n=O("form"),r=O("input"),s=I(),i=O("button"),E(r,"tabindex","0"),E(r,"type","text"),E(i,"type","submit"),E(i,"class","fa fa-circle-plus svelte-1telry2"),E(n,"class","svelte-1telry2")},m(l,u){A(l,e,u),C(e,n),C(n,r),Me(r,t[0].description),C(n,s),C(n,i),o||(a=[q(r,"input",t[3]),q(n,"submit",Y(t[1]))],o=!0)},p(l,[u]){u&1&&r.value!==l[0].description&&Me(r,l[0].description)},i:R,o:R,d(l){l&&P(e),o=!1,de(a)}}}function na(t,e,n){let r;ee(t,Ee,a=>n(2,r=a));let s={description:"",done:!1,tags:r};const i=async()=>{n(0,s.description=s.description.trim(),s)==""?ce("noting to add","alert",2):(await me.insert(s),n(0,s.description="",s),s.tags.splice(0))};function o(){s.description=this.value,n(0,s),n(2,r)}return t.$$.update=()=>{t.$$.dirty&4&&n(0,s.tags=[...r],s)},[s,i,r,o]}class ra extends le{constructor(e){super(),ae(this,e,na,ta,ne,{})}}function ci(t,{from:e,to:n},r={}){const s=getComputedStyle(t),i=s.transform==="none"?"":s.transform,[o,a]=s.transformOrigin.split(" ").map(parseFloat),l=e.left+e.width*o/n.width-(n.left+o),u=e.top+e.height*a/n.height-(n.top+a),{delay:c=0,duration:f=p=>Math.sqrt(p)*120,easing:d=Or}=r;return{delay:c,duration:Ue(f)?f(Math.sqrt(l*l+u*u)):f,easing:d,css:(p,m)=>{const h=m*l,g=m*u,y=p+m*e.width/n.width,_=p+m*e.height/n.height;return`transform: ${i} translate(${h}px, ${g}px) scale(${y}, ${_});`}}}function ns(t,e,n){const r=t.slice();return r[13]=e[n],r}function rs(t){let e,n,r,s;return n=new li({props:{key:t[13],noremove:t[2].done}}),n.$on("click",t[10]),n.$on("remove",t[5]),{c(){e=O("li"),Q(n.$$.fragment),r=I(),E(e,"class","svelte-nckg0g")},m(i,o){A(i,e,o),z(n,e,null),C(e,r),s=!0},p(i,o){const a={};o&4&&(a.key=i[13]),o&4&&(a.noremove=i[2].done),n.$set(a)},i(i){s||(K(n.$$.fragment,i),s=!0)},o(i){D(n.$$.fragment,i),s=!1},d(i){i&&P(e),G(n)}}}function ss(t){let e,n,r,s,i,o,a=t[1]&&is(t);return{c(){e=O("button"),n=I(),a&&a.c(),r=Be(),E(e,"class","fa fa-tag"),E(e,"title","new Tag")},m(l,u){A(l,e,u),A(l,n,u),a&&a.m(l,u),A(l,r,u),s=!0,i||(o=q(e,"click",Y(t[11])),i=!0)},p(l,u){l[1]?a?(a.p(l,u),u&2&&K(a,1)):(a=is(l),a.c(),K(a,1),a.m(r.parentNode,r)):a&&(se(),D(a,1,1,()=>{a=null}),ie())},i(l){s||(K(a),s=!0)},o(l){D(a),s=!1},d(l){l&&P(e),l&&P(n),a&&a.d(l),l&&P(r),i=!1,o()}}}function is(t){let e,n,r;return n=new ui({}),n.$on("submit",t[6]),{c(){e=O("div"),Q(n.$$.fragment),E(e,"class","taginput svelte-nckg0g")},m(s,i){A(s,e,i),z(n,e,null),r=!0},p:R,i(s){r||(K(n.$$.fragment,s),r=!0)},o(s){D(n.$$.fragment,s),r=!1},d(s){s&&P(e),G(n)}}}function sa(t){let e,n,r,s,i,o=t[2].description+"",a,l,u,c,f,d,p,m,h,g=t[2].tags,y=[];for(let v=0;v<g.length;v+=1)y[v]=rs(ns(t,g,v));const _=v=>D(y[v],1,1,()=>{y[v]=null});let b=!t[2].done&&ss(t);return{c(){e=O("article"),n=O("span"),r=O("input"),s=I(),i=O("span"),a=ge(o),l=I(),u=O("button"),c=I(),f=O("ul");for(let v=0;v<y.length;v+=1)y[v].c();d=I(),b&&b.c(),E(r,"type","checkbox"),E(i,"class","txt svelte-nckg0g"),E(u,"class","fa fa-trash-can"),E(u,"title","delete"),E(f,"class","svelte-nckg0g"),E(e,"class","svelte-nckg0g"),we(e,"done",t[2].done)},m(v,k){A(v,e,k),C(e,n),C(n,r),r.checked=t[2].done,C(e,s),C(e,i),C(i,a),C(e,l),C(e,u),C(e,c),C(e,f);for(let w=0;w<y.length;w+=1)y[w]&&y[w].m(f,null);C(e,d),b&&b.m(e,null),p=!0,m||(h=[q(r,"change",t[7]),q(r,"change",t[8]),q(u,"click",Y(t[9]))],m=!0)},p(v,[k]){if(k&4&&(r.checked=v[2].done),(!p||k&4)&&o!==(o=v[2].description+"")&&Lt(a,o),k&52){g=v[2].tags;let w;for(w=0;w<g.length;w+=1){const x=ns(v,g,w);y[w]?(y[w].p(x,k),K(y[w],1)):(y[w]=rs(x),y[w].c(),K(y[w],1),y[w].m(f,null))}for(se(),w=g.length;w<y.length;w+=1)_(w);ie()}v[2].done?b&&(se(),D(b,1,1,()=>{b=null}),ie()):b?(b.p(v,k),k&4&&K(b,1)):(b=ss(v),b.c(),K(b,1),b.m(e,null)),(!p||k&4)&&we(e,"done",v[2].done)},i(v){if(!p){for(let k=0;k<g.length;k+=1)K(y[k]);K(b),p=!0}},o(v){y=y.filter(Boolean);for(let k=0;k<y.length;k+=1)D(y[k]);D(b),p=!1},d(v){v&&P(e),ur(y,v),b&&b.d(),m=!1,de(h)}}}function ia(t,e,n){let r,s=R,i=()=>(s(),s=kn(a,_=>n(2,r=_)),a),o;ee(t,Ee,_=>n(12,o=_)),t.$$.on_destroy.push(()=>s());let{todo:a}=e;i();let l=!1;const u=()=>{confirm("remove todo permanently ?")&&me.drop(a)},c=async _=>{const b=_.data.key;o.indexOf(b)==-1&&(o.push(b),Ee.set(o))},f=async _=>{r.tags.indexOf(_.detail.data.key)!=-1&&confirm("remove Tag?")&&(ct(a,r.tags=r.tags.filter(b=>b&&b!=_.detail.data.key),r),await a.set(r),me.refreshView())},d=async _=>{r.tags.indexOf(_.detail.data.key)==-1&&(r.tags.push(_.detail.data.key),ct(a,r.tags=r.tags.filter(b=>b),r),a.set(r)),n(1,l=!1)};function p(){r.done=this.checked,a.set(r)}const m=()=>me.refreshView(),h=()=>u(),g=_=>c(_.detail),y=()=>n(1,l=!l);return t.$$set=_=>{"todo"in _&&i(n(0,a=_.todo))},[a,l,r,u,c,f,d,p,m,h,g,y]}class fi extends le{constructor(e){super(),ae(this,e,ia,sa,ne,{todo:0})}}function os(t,e,n){const r=t.slice();return r[6]=e[n],r}function as(t,e,n){const r=t.slice();return r[6]=e[n],r}function ls(t,e){let n,r,s,i,o,a=R,l;return r=new fi({props:{todo:e[6]}}),{key:t,first:null,c(){n=O("div"),Q(r.$$.fragment),this.first=n},m(u,c){A(u,n,c),z(r,n,null),l=!0},p(u,c){e=u;const f={};c&2&&(f.todo=e[6]),r.$set(f)},r(){o=n.getBoundingClientRect()},f(){ks(n),a(),cr(n,o)},a(){a(),a=ws(n,o,ci,{duration:di})},i(u){l||(K(r.$$.fragment,u),u&&fe(()=>{l&&(i&&i.end(1),s=pr(n,e[4],{key:e[6].data.id}),s.start())}),l=!0)},o(u){D(r.$$.fragment,u),s&&s.invalidate(),u&&(i=mr(n,e[3],{key:e[6].data.id})),l=!1},d(u){u&&P(n),G(r),u&&i&&i.end()}}}function us(t,e){let n,r,s,i,o,a,l=R,u;return r=new fi({props:{todo:e[6]}}),{key:t,first:null,c(){n=O("div"),Q(r.$$.fragment),s=I(),this.first=n},m(c,f){A(c,n,f),z(r,n,null),C(n,s),u=!0},p(c,f){e=c;const d={};f&1&&(d.todo=e[6]),r.$set(d)},r(){a=n.getBoundingClientRect()},f(){ks(n),l(),cr(n,a)},a(){l(),l=ws(n,a,ci,{duration:di})},i(c){u||(K(r.$$.fragment,c),c&&fe(()=>{u&&(o&&o.end(1),i=pr(n,e[4],{key:e[6].data.id}),i.start())}),u=!0)},o(c){D(r.$$.fragment,c),i&&i.invalidate(),c&&(o=mr(n,e[3],{key:e[6].data.id})),u=!1},d(c){c&&P(n),G(r),c&&o&&o.end()}}}function oa(t){let e=[],n=new Map,r,s,i,o=[],a=new Map,l,u,c=t[1];const f=m=>m[6].data.id;for(let m=0;m<c.length;m+=1){let h=as(t,c,m),g=f(h);n.set(g,e[m]=ls(g,h))}let d=t[0];const p=m=>m[6].data.id;for(let m=0;m<d.length;m+=1){let h=os(t,d,m),g=p(h);a.set(g,o[m]=us(g,h))}return{c(){for(let m=0;m<e.length;m+=1)e[m].c();r=I(),s=O("h3"),s.textContent="Done:",i=I();for(let m=0;m<o.length;m+=1)o[m].c();l=Be()},m(m,h){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(m,h);A(m,r,h),A(m,s,h),A(m,i,h);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(m,h);A(m,l,h),u=!0},p(m,[h]){if(h&2){c=m[1],se();for(let g=0;g<e.length;g+=1)e[g].r();e=In(e,h,f,1,m,c,n,r.parentNode,jr,ls,r,as);for(let g=0;g<e.length;g+=1)e[g].a();ie()}if(h&1){d=m[0],se();for(let g=0;g<o.length;g+=1)o[g].r();o=In(o,h,p,1,m,d,a,l.parentNode,jr,us,l,os);for(let g=0;g<o.length;g+=1)o[g].a();ie()}},i(m){if(!u){for(let h=0;h<c.length;h+=1)K(e[h]);for(let h=0;h<d.length;h+=1)K(o[h]);u=!0}},o(m){for(let h=0;h<e.length;h+=1)D(e[h]);for(let h=0;h<o.length;h+=1)D(o[h]);u=!1},d(m){for(let h=0;h<e.length;h+=1)e[h].d(m);m&&P(r),m&&P(s),m&&P(i);for(let h=0;h<o.length;h+=1)o[h].d(m);m&&P(l)}}}const di=250;function aa(t,e,n){let r,s,i,o,a=R,l=()=>(a(),a=kn(r,f=>n(5,o=f)),r);t.$$.on_destroy.push(()=>a());const[u,c]=Do({fallback:_e});return t.$$.update=()=>{t.$$.dirty&32&&n(1,s=o.filter(f=>!f.data.done)),t.$$.dirty&32&&n(0,i=o.filter(f=>f.data.done))},l(n(2,r=me.store)),[i,s,r,u,c,o]}class la extends le{constructor(e){super(),ae(this,e,aa,oa,ne,{})}}function cs(t){let e,n,r,s,i,o,a;return{c(){e=O("article"),n=ge(`App has been updated. Please reopen the app or 
    `),r=O("a"),r.textContent="reload",E(r,"href","#"),E(e,"class","ViteUpdatePrompt svelte-lnojhr")},m(l,u){A(l,e,u),C(e,n),C(e,r),i=!0,o||(a=q(r,"click",Y(function(){Ue(t[0])&&t[0].apply(this,arguments)})),o=!0)},p(l,u){t=l},i(l){i||(fe(()=>{i&&(s||(s=$e(e,_e,{},!0)),s.run(1))}),i=!0)},o(l){s||(s=$e(e,_e,{},!1)),s.run(0),i=!1},d(l){l&&P(e),l&&s&&s.end(),o=!1,a()}}}function ua(t){let e,n,r=t[0]&&cs(t);return{c(){r&&r.c(),e=Be()},m(s,i){r&&r.m(s,i),A(s,e,i),n=!0},p(s,[i]){s[0]?r?(r.p(s,i),i&1&&K(r,1)):(r=cs(s),r.c(),K(r,1),r.m(e.parentNode,e)):r&&(se(),D(r,1,1,()=>{r=null}),ie())},i(s){n||(K(r),n=!0)},o(s){D(r),n=!1},d(s){r&&r.d(s),s&&P(e)}}}const hi=De();function ca(t,e,n){let r,s=R;return ee(t,hi,i=>n(0,r=i)),t.$$.on_destroy.push(()=>s()),[r]}class fa extends le{constructor(e){super(),ae(this,e,ca,ua,ne,{})}}function da(t){let e,n,r,s,i,o,a;const l=t[5].default,u=yi(l,t,t[4],null);return{c(){e=O("div"),n=O("div"),r=I(),s=O("div"),u&&u.c(),E(n,"class","modalBackdrop "+t[1]+" svelte-ce4pm9"),E(s,"class","modalContent Modal "+t[0]+" svelte-ce4pm9"),E(e,"class","modalContainer svelte-ce4pm9")},m(c,f){A(c,e,f),C(e,n),C(e,r),C(e,s),u&&u.m(s,null),t[6](e),a=!0},p(c,[f]){u&&u.p&&(!a||f&16)&&_i(u,l,c,c[4],a?gi(l,c[4],f,null):bi(c[4]),null)},i(c){a||(K(u,c),fe(()=>{a&&(o&&o.end(1),i=pr(e,Hr,{}),i.start())}),a=!0)},o(c){D(u,c),i&&i.invalidate(),o=mr(e,Hr,{}),a=!1},d(c){c&&P(e),u&&u.d(c),t[6](null),c&&o&&o.end()}}}function ha(t,e,n){let{$$slots:r={},$$scope:s}=e;const i="",o="";let{open:a=!0}=e,l;xs(()=>{document.body.appendChild(l),document.body.style.overflow="hidden",n(3,a=!0)}),Es(()=>{document.body.removeChild(l),document.body.style.overflow="",n(3,a=!1)});function u(c){dn[c?"unshift":"push"](()=>{l=c,n(2,l)})}return t.$$set=c=>{"open"in c&&n(3,a=c.open),"$$scope"in c&&n(4,s=c.$$scope)},[i,o,l,a,s,r,u]}class pi extends le{constructor(e){super(),ae(this,e,ha,da,ne,{contentClass:0,backdropClass:1,open:3})}get contentClass(){return this.$$.ctx[0]}get backdropClass(){return this.$$.ctx[1]}}function fs(t){let e,n,r;return{c(){e=O("a"),e.innerHTML='<li class="fa fa-shield-halved"></li>',E(e,"role","button"),E(e,"href","#"),E(e,"class","unlockbtn svelte-oug3cm")},m(s,i){A(s,e,i),n||(r=q(e,"click",Y(t[7])),n=!0)},p:R,d(s){s&&P(e),n=!1,r()}}}function ds(t){let e,n;return e=new pi({props:{$$slots:{default:[pa]},$$scope:{ctx:t}}}),{c(){Q(e.$$.fragment)},m(r,s){z(e,r,s),n=!0},p(r,s){const i={};s&2062&&(i.$$scope={dirty:s,ctx:r}),e.$set(i)},i(r){n||(K(e.$$.fragment,r),n=!0)},o(r){D(e.$$.fragment,r),n=!1},d(r){G(e,r)}}}function pa(t){let e,n,r,s,i,o,a,l,u,c,f,d,p;return{c(){e=O("article"),n=O("form"),r=O("h6"),s=ge(t[2]),i=ge(":"),o=I(),a=O("a"),a.innerHTML='<li class="fa fa-times"></li>',l=I(),u=O("input"),c=I(),f=O("button"),f.textContent="OK",E(a,"href","#"),E(a,"class","closebtn svelte-oug3cm"),E(u,"type","password"),E(u,"class","svelte-oug3cm"),E(f,"type","submit"),E(n,"class","svelte-oug3cm")},m(m,h){A(m,e,h),C(e,n),C(n,r),C(r,s),C(r,i),C(n,o),C(n,a),C(n,l),C(n,u),Me(u,t[3]),C(n,c),C(n,f),d||(p=[q(a,"click",Y(t[8])),q(u,"input",t[9]),q(n,"submit",Y(t[6]))],d=!0)},p(m,h){h&4&&Lt(s,m[2]),h&8&&u.value!==m[3]&&Me(u,m[3])},d(m){m&&P(e),d=!1,de(p)}}}function ma(t){let e,n,r,s,i,o,a,l,u=t[0]&&t[4]&&fs(t),c=t[1]&&ds(t);return{c(){e=O("a"),n=O("li"),r=I(),u&&u.c(),s=I(),c&&c.c(),i=Be(),E(n,"class","fa"),we(n,"fa-lock",!t[0]),we(n,"fa-lock-open",t[0]),E(e,"role","button"),E(e,"href","#"),E(e,"class","unlockbtn svelte-oug3cm")},m(f,d){A(f,e,d),C(e,n),A(f,r,d),u&&u.m(f,d),A(f,s,d),c&&c.m(f,d),A(f,i,d),o=!0,a||(l=q(e,"click",Y(t[5])),a=!0)},p(f,[d]){(!o||d&1)&&we(n,"fa-lock",!f[0]),(!o||d&1)&&we(n,"fa-lock-open",f[0]),f[0]&&f[4]?u?u.p(f,d):(u=fs(f),u.c(),u.m(s.parentNode,s)):u&&(u.d(1),u=null),f[1]?c?(c.p(f,d),d&2&&K(c,1)):(c=ds(f),c.c(),K(c,1),c.m(i.parentNode,i)):c&&(se(),D(c,1,1,()=>{c=null}),ie())},i(f){o||(K(c),o=!0)},o(f){D(c),o=!1},d(f){f&&P(e),f&&P(r),u&&u.d(f),f&&P(s),c&&c.d(f),f&&P(i),a=!1,l()}}}function ya(t,e,n){let r,s;ee(t,ve,m=>n(10,r=m)),ee(t,yt,m=>n(4,s=m));let i=localStorage.getItem("haslock")==null,o=!1,a="",l="";const u=()=>{i?s?(ve.set(void 0),n(0,i=!1)):(n(2,a="Set a password"),n(1,o=!0)):(n(2,a="Enter your password"),n(1,o=!0))},c=async()=>{if(l.trim().length!=l.length)ce("password can't contain whitespaces at the start or end","error",4);else if(!l.length)ce("password is empty","info",2),n(0,i=!1),ve.set(void 0),n(1,o=!1),n(3,l="");else{const m=await Ht(l);s?(n(0,i=!0),ve.set(m),n(3,l="")):(await xe.encryptAll(m,r),await me.encryptAll(m,r),yt.set(!0),localStorage.setItem("haslock","1"),ve.set(void 0),n(0,i=!1),n(3,l="")),n(1,o=!1)}},f=async()=>{r&&confirm("this will remove the password protectedion from your todos. Continue?")&&(await xe.encryptAll(void 0,r),await me.encryptAll(void 0,r),localStorage.removeItem("haslock"),yt.set(!1),ve.set(void 0),n(0,i=!0),n(3,l=""))},d=()=>n(1,o=!1);function p(){l=this.value,n(3,l)}return[i,o,a,l,s,u,c,f,d,p]}class ga extends le{constructor(e){super(),ae(this,e,ya,ma,ne,{})}}function ar(t){return new TextEncoder().encode(t)}function _a(t){return new TextDecoder().decode(t)}function ba(t,e){if(!ArrayBuffer.isView(t))throw new Error("origBuffer must be an instance of TypedArray");if(!(e instanceof t.constructor))throw new Error("new data must be of same type as origBuffer ",t,e);const n=new t.constructor(t.length+e.length);return n.set(e,0),n.set(t,e.length),n}const gt={Str2Buffer:ar,Buffer2Str:_a,BufferPrepend:ba};function va(t){let e,n,r;return{c(){e=O("a"),e.innerHTML='<li class="fas fa-file-export"></li>',E(e,"role","button"),E(e,"href","#"),E(e,"class"," svelte-uyrwi5"),E(e,"title","export to File")},m(s,i){A(s,e,i),n||(r=q(e,"click",Y(t[0])),n=!0)},p:R,i:R,o:R,d(s){s&&P(e),n=!1,r()}}}function wa(t,e,n){let r,s;ee(t,yt,o=>n(1,r=o)),ee(t,ve,o=>n(2,s=o));async function i(){const o={tags:await xe.toArray(s),todos:await me.toArray(s)},a=gt.Str2Buffer(JSON.stringify(o));let l=r?gt.BufferPrepend((await Pr.encrypt(a,s)).toUint8Array(),ar("ENC")):gt.BufferPrepend(a,ar("RAW"));const u=`data:application/${r?"octet-stream":"json"};base64,${ai.encrypt(l)}`;let c=document.createElement("A");c.href=u,c.download=`export.${r?"bin":"json"}`,document.body.appendChild(c),c.click(),document.body.removeChild(c)}return[i]}class ka extends le{constructor(e){super(),ae(this,e,wa,va,ne,{})}}function hs(t){let e,n;return e=new pi({props:{$$slots:{default:[xa]},$$scope:{ctx:t}}}),{c(){Q(e.$$.fragment)},m(r,s){z(e,r,s),n=!0},p(r,s){const i={};s&4099&&(i.$$scope={dirty:s,ctx:r}),e.$set(i)},i(r){n||(K(e.$$.fragment,r),n=!0)},o(r){D(e.$$.fragment,r),n=!1},d(r){G(e,r)}}}function xa(t){let e,n,r,s,i,o,a,l,u,c,f;return{c(){e=O("article"),n=O("form"),r=O("h6"),r.textContent="Enter the password of the File:",s=I(),i=O("a"),i.innerHTML='<li class="fa fa-times"></li>',o=I(),a=O("input"),l=I(),u=O("button"),u.textContent="OK",E(i,"href","#"),E(i,"class","closebtn svelte-opiijf"),E(a,"type","password"),E(a,"name","pwinput"),E(a,"class","svelte-opiijf"),E(u,"type","submit"),E(n,"class","svelte-opiijf")},m(d,p){A(d,e,p),C(e,n),C(n,r),C(n,s),C(n,i),C(n,o),C(n,a),C(n,l),C(n,u),c||(f=[q(i,"click",Y(t[5])),q(n,"submit",Y(t[3]))],c=!0)},p:R,d(d){d&&P(e),c=!1,de(f)}}}function Ea(t){let e,n,r,s,i,o,a,l=t[0]&&hs(t);return{c(){e=O("a"),e.innerHTML='<li class="fas fa-file-import"></li>',n=I(),l&&l.c(),r=I(),s=O("input"),E(e,"role","button"),E(e,"href","#"),E(e,"class"," svelte-opiijf"),E(e,"title","import from File"),E(s,"type","file"),E(s,"aria-hidden","true"),E(s,"class","svelte-opiijf")},m(u,c){A(u,e,c),A(u,n,c),l&&l.m(u,c),A(u,r,c),A(u,s,c),t[6](s),i=!0,o||(a=q(e,"click",Y(t[4])),o=!0)},p(u,[c]){u[0]?l?(l.p(u,c),c&1&&K(l,1)):(l=hs(u),l.c(),K(l,1),l.m(r.parentNode,r)):l&&(se(),D(l,1,1,()=>{l=null}),ie())},i(u){i||(K(l),i=!0)},o(u){D(l),i=!1},d(u){u&&P(e),u&&P(n),l&&l.d(u),u&&P(r),u&&P(s),t[6](null),o=!1,a()}}}function $a(t,e,n){let r=!1,s=h=>{},i=h=>{};function o(){return n(0,r=!0),new Promise((h,g)=>{s=h,n(1,i=g)})}function a(h){console.log("onPasswordInput",h);let y=h.target.pwinput.value;Ht(y).then(_=>s(_)),n(0,r=!1)}let l;function u(){l.click()}const c=new FileReader;function f(h){c.readAsArrayBuffer(h.target.files[0])}async function d(h){const g=h?.target?.result;if(!g||!(g instanceof ArrayBuffer))return;const y=gt.Buffer2Str(g.slice(0,3));let _={},b="";switch(y){case"ENC":try{let v=await o();const k=Ze.fromUint8Array(new Uint8Array(g.slice(3)));b=gt.Buffer2Str(await Pr.decrypt(k,v))}catch(v){console.error(v),ce("invalid password","error",4)}case"RAW":y==="RAW"&&(b=gt.Buffer2Str(g.slice(3)));try{_=JSON.parse(b)}catch(v){console.error(v),ce("file corrupted","error",4)}break;default:ce("not a valid file","error",4);return}if(!(_.tags&&_.todos)){ce("not a valid file","error",4);return}for(let v of _.tags){if(!v.value||!v.key){ce("encountered currupted tag","error",4);continue}await xe.update({key:v.key,value:v.value,color:v.color||"#a0a0a0"})}for(let v of _.todos){const k={tags:[]};if(!v.description||!v.id){ce("encountered currupted todo","error",4);continue}k.description=v.description,k.done=(v.done||!1)!=!1;let w=parseInt(""+(v.id||0));if(isNaN(w)||(k.id=w),Array.isArray(v.tags))for(let x of v.tags)typeof x=="string"&&k.tags.push(x);await me.update(k)}ce("import finished","success",3),me.refreshView()}xs(()=>{l.addEventListener("change",f),c.addEventListener("load",d)}),Es(()=>{l.removeEventListener("change",f),c.removeEventListener("load",d)});const p=()=>{n(0,r=!1),i("abort")};function m(h){dn[h?"unshift":"push"](()=>{l=h,n(2,l)})}return[r,i,l,a,u,p,m]}class Sa extends le{constructor(e){super(),ae(this,e,$a,Ea,ne,{})}}function Ca(t){let e,n,r,s,i,o,a,l,u,c,f,d,p,m;return e=new ka({}),r=new Sa({}),i=new ea({}),u=new ra({}),f=new la({}),p=new jo({}),{c(){Q(e.$$.fragment),n=I(),Q(r.$$.fragment),s=I(),Q(i.$$.fragment),o=I(),a=O("h1"),a.textContent="Todos",l=I(),Q(u.$$.fragment),c=I(),Q(f.$$.fragment),d=I(),Q(p.$$.fragment),E(a,"class","text-center")},m(h,g){z(e,h,g),A(h,n,g),z(r,h,g),A(h,s,g),z(i,h,g),A(h,o,g),A(h,a,g),A(h,l,g),z(u,h,g),A(h,c,g),z(f,h,g),A(h,d,g),z(p,h,g),m=!0},i(h){m||(K(e.$$.fragment,h),K(r.$$.fragment,h),K(i.$$.fragment,h),K(u.$$.fragment,h),K(f.$$.fragment,h),K(p.$$.fragment,h),m=!0)},o(h){D(e.$$.fragment,h),D(r.$$.fragment,h),D(i.$$.fragment,h),D(u.$$.fragment,h),D(f.$$.fragment,h),D(p.$$.fragment,h),m=!1},d(h){G(e,h),h&&P(n),G(r,h),h&&P(s),G(i,h),h&&P(o),h&&P(a),h&&P(l),G(u,h),h&&P(c),G(f,h),h&&P(d),G(p,h)}}}function Pa(t){let e;return{c(){e=ge("please enter your password first")},m(n,r){A(n,e,r)},i:R,o:R,d(n){n&&P(e)}}}function Oa(t){let e,n,r,s,i,o,a,l,u,c,f,d,p;i=new ga({});const m=[Pa,Ca],h=[];function g(y,_){return y[0]&&!y[1]?0:1}return a=g(t),l=h[a]=m[a](t),c=new Uo({}),d=new fa({}),{c(){e=O("base"),n=I(),r=O("nav"),r.innerHTML=`<ul><li><strong>HelloWorld Todo&#39;s</strong></li></ul> 
    <ul><li><a href="https://github.com/Rocco-Gossmann/SvelteHelloWorldTodos" target="_blank">GitHub</a></li></ul>`,s=I(),Q(i.$$.fragment),o=I(),l.c(),u=I(),Q(c.$$.fragment),f=I(),Q(d.$$.fragment),E(e,"href","/SvelteHelloWorldTodos")},m(y,_){C(document.head,e),A(y,n,_),A(y,r,_),A(y,s,_),z(i,y,_),A(y,o,_),h[a].m(y,_),A(y,u,_),z(c,y,_),A(y,f,_),z(d,y,_),p=!0},p(y,[_]){let b=a;a=g(y),a!==b&&(se(),D(h[b],1,1,()=>{h[b]=null}),ie(),l=h[a],l||(l=h[a]=m[a](y),l.c()),K(l,1),l.m(u.parentNode,u))},i(y){p||(K(i.$$.fragment,y),K(l),K(c.$$.fragment,y),K(d.$$.fragment,y),p=!0)},o(y){D(i.$$.fragment,y),D(l),D(c.$$.fragment,y),D(d.$$.fragment,y),p=!1},d(y){P(e),y&&P(n),y&&P(r),y&&P(s),G(i,y),y&&P(o),h[a].d(y),y&&P(u),G(c,y),y&&P(f),G(d,y)}}}function Aa(t,e,n){let r,s;return ee(t,yt,i=>n(0,r=i)),ee(t,ve,i=>n(1,s=i)),[r,s]}class Ta extends le{constructor(e){super(),ae(this,e,Aa,Oa,ne,{})}}const Ka="modulepreload",ja=function(t){return"/SvelteHelloWorldTodos/"+t},ps={},Ba=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=ja(i),i in ps)return;ps[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=s.length-1;c>=0;c--){const f=s[c];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Ka,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((c,f)=>{u.addEventListener("load",c),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};function Da(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,l,u;const c=async(d=!0)=>{await l,await u?.()};async function f(){if("serviceWorker"in navigator){const{Workbox:d}=await Ba(()=>import("./workbox-window.prod.es5-08b2315b.js"),[]);a=new d("/SvelteHelloWorldTodos/sw.js",{scope:"/SvelteHelloWorldTodos/",type:"classic"}),u=async()=>{await a?.messageSkipWaiting()};{let p=!1;const m=()=>{p=!0,a?.addEventListener("controlling",h=>{h.isUpdate&&window.location.reload()}),n?.()};a.addEventListener("installed",h=>{typeof h.isUpdate>"u"?typeof h.isExternal<"u"?h.isExternal?m():!p&&r?.():h.isExternal?window.location.reload():!p&&r?.():h.isUpdate||r?.()}),a.addEventListener("waiting",m),a.addEventListener("externalwaiting",m)}a.register({immediate:e}).then(p=>{i?i("/SvelteHelloWorldTodos/sw.js",p):s?.(p)}).catch(p=>{o?.(p)})}}return l=f(),c}new Ta({target:document.getElementById("app")});const Ia=Da({onNeedRefresh(){hi.set(Ia)}});
